r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 10.1124202601957
Parameter containing:
tensor([-0.3067,  3.1371, -0.3553], requires_grad=True)
tensor(0.9030) Parameter containing:
tensor(49.2808, requires_grad=True)
tensor(-0.2960) Parameter containing:
tensor(94.9625, requires_grad=True)
tensor(-0.1822) Parameter containing:
tensor(95.0145, requires_grad=True)
Parameter containing:
tensor([0.6905, 1.0170, 1.0089], requires_grad=True)
Epoch 1
  2%|██▌                                                                                                                                                        | 118/7040 [01:08<1:04:53,  1.78it/s]  2%|██▌
                                                                                                                                                      | 118/7040 [01:08<1:07:05,  1.72it/s]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 500, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 422, in train
    scaler.scale(disc_loss).backward()
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/usr/local/lib/python3.10/dist-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.000125
Resuming from model with val loss: 10.1124202601957
Parameter containing:
tensor([-0.3067,  3.1371, -0.3553], requires_grad=True)
tensor(0.9030) Parameter containing:
tensor(49.2808, requires_grad=True)
tensor(-0.2960) Parameter containing:
tensor(94.9625, requires_grad=True)
tensor(-0.1822) Parameter containing:
tensor(95.0145, requires_grad=True)
Parameter containing:
tensor([0.6905, 1.0170, 1.0089], requires_grad=True)
Epoch 1
  1%|█                                                                                                                                                           | 46/7040 [00:28<1:05:02,  1.79it/s]  1%|█
                                                                                                                                                       | 46/7040 [00:29<1:13:55,  1.58it/s]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 500, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 423, in train
    scaler.step(opt_dis)
  File "/usr/local/lib/python3.10/dist-packages/torch/cuda/amp/grad_scaler.py", line 374, in step
    retval = self._maybe_opt_step(optimizer, optimizer_state, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/cuda/amp/grad_scaler.py", line 289, in _maybe_opt_step
    if not sum(v.item() for v in optimizer_state["found_inf_per_device"].values()):
  File "/usr/local/lib/python3.10/dist-packages/torch/cuda/amp/grad_scaler.py", line 289, in <genexpr>
    if not sum(v.item() for v in optimizer_state["found_inf_per_device"].values()):
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.000125
Resuming from model with val loss: 10.1124202601957
Parameter containing:
tensor([-0.3067,  3.1371, -0.3553], requires_grad=True)
tensor(0.9030) Parameter containing:
tensor(49.2808, requires_grad=True)
tensor(-0.2960) Parameter containing:
tensor(94.9625, requires_grad=True)
tensor(-0.1822) Parameter containing:
tensor(95.0145, requires_grad=True)
Parameter containing:
tensor([0.6905, 1.0170, 1.0089], requires_grad=True)
Epoch 1
  2%|██▍                                                                                                                                                        | 111/7040 [01:04<1:02:32,  1.85it/s]  2%|██▍
                                                                                                                                                      | 111/7040 [01:05<1:07:38,  1.71it/s]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 500, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 425, in train
    scaler.scale(loss).backward()
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/usr/local/lib/python3.10/dist-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.000125
Resuming from model with val loss: 10.1124202601957
Parameter containing:
tensor([-0.3067,  3.1371, -0.3553], requires_grad=True)
tensor(0.9030) Parameter containing:
tensor(49.2808, requires_grad=True)
tensor(-0.2960) Parameter containing:
tensor(94.9625, requires_grad=True)
tensor(-0.1822) Parameter containing:
tensor(95.0145, requires_grad=True)
Parameter containing:
tensor([0.6905, 1.0170, 1.0089], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:21:48<00:00,  1.43it/s]
Train loss: 7.7920796043165454, Disc Loss: 49.76824396306818, Adv Loss: -0.22231996655464173, Recon Loss: 4.4296750881793825, Time Loss: 0.22169366224605422
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:22<00:00,  3.98it/s]
Valid loss: 8.734776853431354, Dist Loss: 0.0, Recon Loss: 4.367388426715677, Time Loss: 0.2639166273917495
Validation loss decreased (10.112420 --> 8.734777).  Saving model ...
tensor([-0.0122, -0.0084, -0.0111,  ...,  0.0189,  0.0188,  0.0178],
       device='cuda:0') -0.2978246212005615 0.42275702953338623
tensor([-0.0111, -0.0118, -0.0116,  ..., -0.0622, -0.0586, -0.0546],
       device='cuda:0') -1.4018399715423584 1.486191987991333
tensor([-0.0092, -0.0098, -0.0094,  ..., -0.0408, -0.0397, -0.0382],
       device='cuda:0') -0.43714311718940735 0.538731575012207
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:21:56<00:00,  1.43it/s]
Train loss: 8.803159592235566, Disc Loss: 49.59195667613636, Adv Loss: -0.0923652865669944, Recon Loss: 4.610333445837552, Time Loss: 0.22160540606921791
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:22<00:00,  3.97it/s]
Valid loss: 9.0470140687444, Dist Loss: 0.0, Recon Loss: 4.5235070343722, Time Loss: 0.2649166444888
EarlyStopping counter: 1 out of 10
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:22:01<00:00,  1.43it/s]
Train loss: 10.433268877118296, Disc Loss: 49.322021484375, Adv Loss: 0.2190592874180187, Recon Loss: 4.646703295646743, Time Loss: 0.2228024836936542
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:21<00:00,  3.99it/s]
Valid loss: 9.222231792319905, Dist Loss: 0.0, Recon Loss: 4.611115896159952, Time Loss: 0.2677234433231537
EarlyStopping counter: 2 out of 10
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:22:00<00:00,  1.43it/s]
Train loss: 11.220725366828793, Disc Loss: 48.834303977272725, Adv Loss: 0.37193742882121694, Recon Loss: 4.658268709548495, Time Loss: 0.2224803963019936
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:22<00:00,  3.98it/s]
Valid loss: 9.29366464343938, Dist Loss: 0.0, Recon Loss: 4.64683232171969, Time Loss: 0.26407580259891056
EarlyStopping counter: 3 out of 10
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:21:50<00:00,  1.43it/s]
Train loss: 10.585385067958322, Disc Loss: 47.89441139914773, Adv Loss: 0.18585357666015626, Recon Loss: 4.8057840127497915, Time Loss: 0.22274996709152634
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:16<00:00,  4.03it/s]
Valid loss: 10.066142402995716, Dist Loss: 0.0, Recon Loss: 5.033071201497858, Time Loss: 0.2626431872782467
EarlyStopping counter: 4 out of 10
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:21:41<00:00,  1.44it/s]
Train loss: 13.39057263572785, Disc Loss: 46.70521351207386, Adv Loss: 0.6763664245605469, Recon Loss: 4.982029557600617, Time Loss: 0.22329968075871215
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:19<00:00,  4.00it/s]
Valid loss: 9.967477722330527, Dist Loss: 0.0, Recon Loss: 4.983738861165263, Time Loss: 0.2780086198229004
EarlyStopping counter: 5 out of 10
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:20:58<00:00,  1.45it/s]
Train loss: 17.536457153274256, Disc Loss: 45.62187056107955, Adv Loss: 1.4215240781957452, Recon Loss: 5.192136317186735, Time Loss: 0.22279085418082434
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:21<00:00,  3.99it/s]
Valid loss: 10.412587154453451, Dist Loss: 0.0, Recon Loss: 5.206293577226726, Time Loss: 0.26483954447321595
EarlyStopping counter: 6 out of 10
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:21:49<00:00,  1.43it/s]
Train loss: 22.15495267612013, Disc Loss: 43.6728515625, Adv Loss: 2.2460545669902454, Recon Loss: 5.43993811478669, Time Loss: 0.2241423115848606
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:20<00:00,  3.99it/s]
Valid loss: 10.886020724339918, Dist Loss: 0.0, Recon Loss: 5.443010362169959, Time Loss: 0.27069407785734667
EarlyStopping counter: 7 out of 10
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:21:49<00:00,  1.43it/s]
Train loss: 26.95537713928656, Disc Loss: 41.00645640980114, Adv Loss: 3.147208647294478, Recon Loss: 5.58695148575035, Time Loss: 0.22690830031536857
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:22<00:00,  3.98it/s]
Valid loss: 10.01644566709345, Dist Loss: 0.0, Recon Loss: 5.008222833546725, Time Loss: 0.26630932785972783
EarlyStopping counter: 8 out of 10
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:21:45<00:00,  1.44it/s]
Train loss: 27.774380769648335, Disc Loss: 40.655064808238635, Adv Loss: 3.272070329839533, Recon Loss: 5.68433599526232, Time Loss: 0.226723384360296
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:18<00:00,  4.01it/s]
Valid loss: 11.022030356255444, Dist Loss: 0.0, Recon Loss: 5.511015178127722, Time Loss: 0.2779936765913259
EarlyStopping counter: 9 out of 10
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:22:16<00:00,  1.43it/s]
Train loss: 30.02076875933192, Disc Loss: 39.269877485795455, Adv Loss: 3.674937369606712, Recon Loss: 5.800446136295795, Time Loss: 0.2258072256803809
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:24<00:00,  3.96it/s]
Valid loss: 10.859686776182869, Dist Loss: 0.0, Recon Loss: 5.4298433880914345, Time Loss: 0.2704597886630588
EarlyStopping counter: 10 out of 10
Early stopping
r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 10.1124202601957
Parameter containing:
tensor([-0.3067,  3.1371, -0.3553], device='cuda:0', requires_grad=True)
tensor(0.9030, device='cuda:0') Parameter containing:
tensor(49.2808, device='cuda:0', requires_grad=True)
tensor(-0.2960, device='cuda:0') Parameter containing:
tensor(94.9625, device='cuda:0', requires_grad=True)
tensor(-0.1822, device='cuda:0') Parameter containing:
tensor(95.0145, device='cuda:0', requires_grad=True)
Parameter containing:
tensor([0.6905, 1.0170, 1.0089], device='cuda:0', requires_grad=True)
Epoch 1
  2%|███▍                                                                                                                                                        | 66/3018 [01:24<1:13:53,  1.50s/it]  2%|███▍
                                                                                                                                                       | 66/3018 [01:25<1:03:43,  1.30s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 500, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 426, in train
    scaler.step(opt)
  File "/usr/local/lib/python3.10/dist-packages/torch/cuda/amp/grad_scaler.py", line 374, in step
    retval = self._maybe_opt_step(optimizer, optimizer_state, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/cuda/amp/grad_scaler.py", line 290, in _maybe_opt_step
    retval = optimizer.step(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/optim/optimizer.py", line 280, in wrapper
    out = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/optim/optimizer.py", line 33, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/optim/adamw.py", line 171, in step
    adamw(
  File "/usr/local/lib/python3.10/dist-packages/torch/optim/adamw.py", line 321, in adamw
    func(
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 10.1124202601957
Parameter containing:
tensor([-0.3067,  3.1371, -0.3553], device='cuda:0', requires_grad=True)
tensor(0.9030, device='cuda:0') Parameter containing:
tensor(49.2808, device='cuda:0', requires_grad=True)
tensor(-0.2960, device='cuda:0') Parameter containing:
tensor(94.9625, device='cuda:0', requires_grad=True)
tensor(-0.1822, device='cuda:0') Parameter containing:
tensor(95.0145, device='cuda:0', requires_grad=True)
Parameter containing:
tensor([0.6905, 1.0170, 1.0089], device='cuda:0', requires_grad=True)
Epoch 1
  0%|▎                                                                                                                                                            | 6/3018 [00:09<1:05:22,  1.30s/it]  0%|▎
                                                                                                                                                        | 6/3018 [00:09<1:19:00,  1.57s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 500, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 379, in train
    beginning = peak_norm(apply_augmentations(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 160, in pitch_shift
    output = stretcher(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/transforms/_transforms.py", line 1110, in forward
    return F.phase_vocoder(complex_specgrams, rate, self.phase_advance)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/functional/functional.py", line 789, in phase_vocoder
    phase = torch.cat([phase_0, phase[..., :-1]], dim=-1)
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 10.1124202601957
Parameter containing:
tensor([-0.3067,  3.1371, -0.3553], device='cuda:0', requires_grad=True)
tensor(0.9030, device='cuda:0') Parameter containing:
tensor(49.2808, device='cuda:0', requires_grad=True)
tensor(-0.2960, device='cuda:0') Parameter containing:
tensor(94.9625, device='cuda:0', requires_grad=True)
tensor(-0.1822, device='cuda:0') Parameter containing:
tensor(95.0145, device='cuda:0', requires_grad=True)
Parameter containing:
tensor([0.6905, 1.0170, 1.0089], device='cuda:0', requires_grad=True)
Epoch 1
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:24<00:00,  1.06s/it]
Train loss: 10.09274950716336, Dist Loss: 242.3378462434368, Recon Loss: 5.0221409699709865, Time Loss: 0.19378442493513612
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:23<00:00,  1.70it/s]
Valid loss: 10.370787902225722, Dist Loss: 286.1402100013581, Recon Loss: 5.156779935975738, Time Loss: 0.2593854131041378
EarlyStopping counter: 1 out of 10
Epoch 2
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:30<00:00,  1.06s/it]
Train loss: 10.057021291466087, Dist Loss: 210.6827587522048, Recon Loss: 5.007442367558767, Time Loss: 0.1961255268205508
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:22<00:00,  1.71it/s]
Valid loss: 10.47856797098324, Dist Loss: 261.1308689092169, Recon Loss: 5.213170902302723, Time Loss: 0.26311867468503136
EarlyStopping counter: 2 out of 10
Epoch 3
 12%|████████████████████▌                                                                                                                                                  | 372/3018 [06:37<55:03,  12%|█████
███████████████▍                                                                                                                                                | 373/3018 [06:39<1:00:54,  12%|███████████████
█████▋                                                                                                                                                  | 374/3018 [06:40<59:06,  12%|████████████████████▌
                                                                                                                                            | 375/3018 [06:42<1:00:44,  12%|████████████████████▊
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:40<00:00,  1.07s/it]
Train loss: 10.027084236511575, Dist Loss: 189.3348644880999, Recon Loss: 4.994608630716919, Time Loss: 0.19629579138892073
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:22<00:00,  1.70it/s]
Valid loss: 10.278779847100871, Dist Loss: 237.91619498145502, Recon Loss: 5.115598307855872, Time Loss: 0.26462625836003695
EarlyStopping counter: 3 out of 10
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [54:17<00:00,  1.08s/it]
Train loss: 9.987545692817987, Dist Loss: 172.48051555777639, Recon Loss: 4.976524797790963, Time Loss: 0.1954427410245455
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:23<00:00,  1.70it/s]
Valid loss: 10.288189147797642, Dist Loss: 223.3838138706637, Recon Loss: 5.121756202495651, Time Loss: 0.2578627270677232
EarlyStopping counter: 4 out of 10
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:05<00:00,  1.06s/it]
Train loss: 9.963194251771476, Dist Loss: 161.72314132136805, Recon Loss: 4.96542481447072, Time Loss: 0.19544021994853114
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:21<00:00,  1.71it/s]
Valid loss: 10.192444125548104, Dist Loss: 214.19682010878, Recon Loss: 5.074802389208054, Time Loss: 0.27026703223980814
EarlyStopping counter: 5 out of 10
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:30<00:00,  1.06s/it]
Train loss: 9.898104402069386, Dist Loss: 154.31718174837692, Recon Loss: 4.933620486376379, Time Loss: 0.19608816736290755
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:27<00:00,  1.69it/s]
Valid loss: 10.00984511722792, Dist Loss: 200.79578423405326, Recon Loss: 4.984842976829074, Time Loss: 0.25958804877980657
Validation loss decreased (10.112420 --> 10.009845).  Saving model ...
tensor([0.0132, 0.0229, 0.0196,  ..., 0.0435, 0.0437, 0.0432], device='cuda:0') -0.47548529505729675 0.4983690679073334
tensor([-0.0011, -0.0007, -0.0016,  ..., -0.0236, -0.0238, -0.0228],
       device='cuda:0') -1.5469411611557007 1.5265536308288574
tensor([-0.0002,  0.0002, -0.0007,  ..., -0.0107, -0.0089, -0.0059],
       device='cuda:0') -0.4038860499858856 0.4189488887786865
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [54:15<00:00,  1.08s/it]
Train loss: 9.889284027104665, Dist Loss: 145.97072186100317, Recon Loss: 4.930044943959291, Time Loss: 0.1951347515530109
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:20<00:00,  1.71it/s]
Valid loss: 10.027090325260794, Dist Loss: 194.2089983605391, Recon Loss: 4.994124264117108, Time Loss: 0.25863686930264856
EarlyStopping counter: 1 out of 10
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [54:26<00:00,  1.08s/it]
Train loss: 9.868440250437176, Dist Loss: 140.87723858645612, Recon Loss: 4.92013240255529, Time Loss: 0.196980107679341
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:24<00:00,  1.70it/s]
Valid loss: 10.150746231836989, Dist Loss: 191.59860292144168, Recon Loss: 5.056213259539067, Time Loss: 0.28246937584107285
EarlyStopping counter: 2 out of 10
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [54:07<00:00,  1.08s/it]
Train loss: 9.808610971752897, Dist Loss: 133.71269758589779, Recon Loss: 4.890934217995251, Time Loss: 0.1961813358549273
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:24<00:00,  1.70it/s]
Valid loss: 10.263425214401144, Dist Loss: 177.0843257828264, Recon Loss: 5.114004174920897, Time Loss: 0.2574528913377531
EarlyStopping counter: 3 out of 10
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:27<00:00,  1.06s/it]
Train loss: 9.783040150022412, Dist Loss: 127.62181443580339, Recon Loss: 4.878757893604661, Time Loss: 0.19672943257052153
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:23<00:00,  1.70it/s]
Valid loss: 10.239500192301163, Dist Loss: 164.6462716563648, Recon Loss: 5.103285476229838, Time Loss: 0.2628441249051236
EarlyStopping counter: 4 out of 10
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [54:27<00:00,  1.08s/it]
Train loss: 9.760426637903597, Dist Loss: 122.22917790757337, Recon Loss: 4.867990401661736, Time Loss: 0.196404326670094
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:22<00:00,  1.71it/s]
Valid loss: 10.117896613064191, Dist Loss: 164.75577186432895, Recon Loss: 5.042472732619734, Time Loss: 0.26863352541891944
EarlyStopping counter: 5 out of 10
Epoch 12
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:36<00:00,  1.07s/it]
Train loss: 9.713569417072495, Dist Loss: 118.67307782283756, Recon Loss: 4.8449174017997825, Time Loss: 0.19692963128940327
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:23<00:00,  1.70it/s]
Valid loss: 10.293663962155778, Dist Loss: 165.72912469825997, Recon Loss: 5.130259070491159, Time Loss: 0.27268367486185585
EarlyStopping counter: 6 out of 10
Epoch 13
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:18<00:00,  1.06s/it]
Train loss: 9.686537596940836, Dist Loss: 114.38117527914332, Recon Loss: 4.831830682305803, Time Loss: 0.19583748460230724
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:23<00:00,  1.70it/s]
Valid loss: 9.900849517923318, Dist Loss: 150.52067305710142, Recon Loss: 4.935372691754473, Time Loss: 0.26805141608644006
Validation loss decreased (10.009845 --> 9.900850).  Saving model ...
tensor([0.0160, 0.0227, 0.0216,  ..., 0.0354, 0.0352, 0.0347], device='cuda:0') -0.4186832904815674 0.4452180564403534
tensor([ 0.0065,  0.0064,  0.0076,  ..., -0.0299, -0.0312, -0.0311],
       device='cuda:0') -1.4837177991867065 1.557653784751892
tensor([-0.0004, -0.0006,  0.0006,  ..., -0.0075, -0.0048, -0.0015],
       device='cuda:0') -0.46127358078956604 0.4914511442184448
Epoch 14
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:57<00:00,  1.07s/it]
Train loss: 9.667215300838706, Dist Loss: 108.89763595348482, Recon Loss: 4.82271788521584, Time Loss: 0.19617093619356651
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:21<00:00,  1.71it/s]
Valid loss: 10.136397477964692, Dist Loss: 145.3175515282233, Recon Loss: 5.053666975008731, Time Loss: 0.26618491335223055
EarlyStopping counter: 1 out of 10
Epoch 15
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:50<00:00,  1.07s/it]
Train loss: 9.634821498844307, Dist Loss: 104.52456806415434, Recon Loss: 4.806958288527072, Time Loss: 0.19655396963850483
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:20<00:00,  1.71it/s]
Valid loss: 10.12514847003861, Dist Loss: 149.27924861781645, Recon Loss: 5.047646311576793, Time Loss: 0.26791700053688705
EarlyStopping counter: 2 out of 10
Epoch 16
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:48<00:00,  1.07s/it]
Train loss: 9.626321247352362, Dist Loss: 101.04419290189952, Recon Loss: 4.803056203505312, Time Loss: 0.19582483594320008
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:23<00:00,  1.70it/s]
Valid loss: 9.812762280647329, Dist Loss: 139.47763056976117, Recon Loss: 4.892433374291224, Time Loss: 0.2660628861396123
Validation loss decreased (9.900850 --> 9.812762).  Saving model ...
tensor([0.0289, 0.0428, 0.0422,  ..., 0.0434, 0.0421, 0.0406], device='cuda:0') -0.3860027492046356 0.4376155734062195
tensor([-0.0046, -0.0024,  0.0004,  ..., -0.0272, -0.0307, -0.0329],
       device='cuda:0') -1.4943301677703857 1.4971816539764404
tensor([-0.0029, -0.0006,  0.0019,  ..., -0.0088, -0.0075, -0.0053],
       device='cuda:0') -0.4381669759750366 0.4801231622695923
Epoch 17
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:11<00:00,  1.06s/it]
Train loss: 9.610111553673717, Dist Loss: 99.63375131810557, Recon Loss: 4.79509240337521, Time Loss: 0.19705006043748244
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:22<00:00,  1.71it/s]
Valid loss: 10.028221040687814, Dist Loss: 133.60256819567144, Recon Loss: 5.000750263163585, Time Loss: 0.26064638362716364
EarlyStopping counter: 1 out of 10
Epoch 18
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:56<00:00,  1.07s/it]
Train loss: 9.608048290824005, Dist Loss: 94.43159172406965, Recon Loss: 4.794580987465152, Time Loss: 0.19630673061871148
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:20<00:00,  1.71it/s]
Valid loss: 10.01777945764807, Dist Loss: 133.08647613020133, Recon Loss: 4.99558108373983, Time Loss: 0.2633866054579517
EarlyStopping counter: 2 out of 10
Epoch 19
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:37<00:00,  1.07s/it]
Train loss: 9.57516802281556, Dist Loss: 93.95878822239446, Recon Loss: 4.778188131596569, Time Loss: 0.19594201101193845
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:23<00:00,  1.70it/s]
Valid loss: 10.040789082508214, Dist Loss: 126.44279755851291, Recon Loss: 5.007750268014061, Time Loss: 0.26481186975509124
EarlyStopping counter: 3 out of 10
Epoch 20
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [54:16<00:00,  1.08s/it]
Train loss: 9.538718876576407, Dist Loss: 91.23488473260221, Recon Loss: 4.760235949728646, Time Loss: 0.19721044403253365
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:21<00:00,  1.71it/s]
Valid loss: 9.884564431297859, Dist Loss: 127.13037374130148, Recon Loss: 4.929569175543374, Time Loss: 0.26189335694672256
EarlyStopping counter: 4 out of 10
Epoch 21
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:28<00:00,  1.06s/it]
Train loss: 9.537903639241668, Dist Loss: 88.70854321752185, Recon Loss: 4.760080966829385, Time Loss: 0.19717548027476622
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:20<00:00,  1.71it/s]
Valid loss: 10.170768358849532, Dist Loss: 123.33232822544528, Recon Loss: 5.073050937273645, Time Loss: 0.2620897114128861
EarlyStopping counter: 5 out of 10
Epoch 22
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [52:51<00:00,  1.05s/it]
Train loss: 9.547754309839409, Dist Loss: 88.85953178399441, Recon Loss: 4.764991202916903, Time Loss: 0.19721945040940134
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:24<00:00,  1.70it/s]
Valid loss: 10.106505129984672, Dist Loss: 120.30532801798637, Recon Loss: 5.041222031069117, Time Loss: 0.2685280856608555
EarlyStopping counter: 6 out of 10
Epoch 23
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3018/3018 [53:43<00:00,  1.07s/it]
Train loss: 9.520900727740338, Dist Loss: 85.71177300686391, Recon Loss: 4.751879184430921, Time Loss: 0.19728896223043194
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 755/755 [07:22<00:00,  1.71it/s]
Valid loss: 10.059551408275073, Dist Loss: 122.35916393861076, Recon Loss: 5.017539786660908, Time Loss: 0.26309570982953573
EarlyStopping counter: 7 out of 10
Epoch 24
 43%|███████████████████████████████████████████████████████████████████████▋                                                                                              | 1304/3018 [22:43<36:30,  1.28s/it]
 43%|███████████████████████████████████████████████████████████████████████▋                                                                                              | 1304/3018 [22:43<29:52,  1.05s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 500, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 379, in train
    beginning = peak_norm(apply_augmentations(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 160, in pitch_shift
    output = stretcher(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/transforms/_transforms.py", line 1110, in forward
    return F.phase_vocoder(complex_specgrams, rate, self.phase_advance)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/functional/functional.py", line 778, in phase_vocoder
    angle_0 = complex_specgrams_0.angle()
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$
