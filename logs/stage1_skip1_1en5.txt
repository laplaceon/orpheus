r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31108448
Learning rate: 0.00015
Parameter containing:
tensor([1., 1., 1.], device='cuda:0', requires_grad=True)
tensor(1., device='cuda:0') Parameter containing:
tensor(100., device='cuda:0', requires_grad=True)
tensor(1., device='cuda:0') Parameter containing:
tensor(5., device='cuda:0', requires_grad=True)
tensor(1., device='cuda:0') Parameter containing:
tensor(10., device='cuda:0', requires_grad=True)
Parameter containing:
tensor([1., 1., 1.], device='cuda:0', requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:09<00:00,  1.16it/s]
Train loss: 23.78538967172305, Dist Loss: 26018.22265364329, Recon Loss: 11.892694835861525, FB Loss: 11.36285100132227, Time Loss: 0.4805565133031147
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:24<00:00,  2.16it/s]
Valid loss: 19.13430048326651, Dist Loss: 24363.82731221517, Recon Loss: 8.34895889957746, FB Loss: 7.907054550449053, Time Loss: 0.3630565640516579
Validation loss decreased (inf --> 19.134300).  Saving model ...
tensor([-1.4886,  0.7638,  1.7811,  ..., -0.0101, -0.0173, -0.0313],
       device='cuda:0') -9.965238571166992 9.317034721374512
tensor([-1.4792,  0.7914,  1.7975,  ..., -0.0213, -0.0366, -0.0547],
       device='cuda:0') -9.965691566467285 9.320165634155273
tensor([-1.4828,  0.7853,  1.7966,  ..., -0.0094, -0.0158, -0.0301],
       device='cuda:0') -9.963428497314453 9.315863609313965
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:10<00:00,  1.16it/s]
Train loss: 16.32808013111353, Dist Loss: 3836.060068353017, Recon Loss: 7.972237066179514, FB Loss: 8.702653655409813, Time Loss: 0.29684157892673585
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:28<00:00,  2.14it/s]
Valid loss: 12.49775178829829, Dist Loss: 2528.739946651459, Recon Loss: 6.12243890563647, FB Loss: 6.4831830397248265, Time Loss: 0.333997959503904
Validation loss decreased (19.134300 --> 12.497752).  Saving model ...
tensor([1.3931, 0.2997, 2.6793,  ..., 0.0214, 0.0125, 0.0177], device='cuda:0') -9.813621520996094 10.480155944824219
tensor([ 1.3917,  0.2985,  2.6776,  ..., -0.0076, -0.0202, -0.0167],
       device='cuda:0') -9.828426361083984 10.478804588317871
tensor([ 1.3923e+00,  3.0717e-01,  2.6819e+00,  ..., -5.3652e-04,
        -9.0110e-03, -7.5110e-03], device='cuda:0') -9.807804107666016 10.485568046569824
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:22<00:00,  1.16it/s]
Train loss: 13.553206633031369, Dist Loss: 1405.9975073695182, Recon Loss: 6.706303451334437, FB Loss: 7.459553463757038, Time Loss: 0.2715959766219991
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:22<00:00,  2.17it/s]
Valid loss: 11.562268455823263, Dist Loss: 2087.7246509552, Recon Loss: 5.676748007039229, FB Loss: 5.964598436653614, Time Loss: 0.30883772685192523
Validation loss decreased (12.497752 --> 11.562268).  Saving model ...
tensor([ 2.2519, -0.3526,  2.8446,  ...,  0.0197,  0.0158,  0.0213],
       device='cuda:0') -8.48483657836914 9.764811515808105
tensor([ 2.2650, -0.3344,  2.8503,  ..., -0.0335, -0.0419, -0.0351],
       device='cuda:0') -8.538578987121582 9.826391220092773
tensor([ 2.2590, -0.3472,  2.8447,  ..., -0.0312, -0.0342, -0.0312],
       device='cuda:0') -8.484759330749512 9.763662338256836
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:45<00:00,  1.15it/s]
Train loss: 12.421762105822562, Dist Loss: 1107.9017785509427, Recon Loss: 6.155485965808233, FB Loss: 6.831997377425433, Time Loss: 0.25164591703408706
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:26<00:00,  2.15it/s]
Valid loss: 10.898011709252993, Dist Loss: 1612.6480070432028, Recon Loss: 5.3683734521269795, FB Loss: 5.744233558575313, Time Loss: 0.30183541983521234
Validation loss decreased (11.562268 --> 10.898012).  Saving model ...
tensor([ 1.9181, -0.1490,  2.8561,  ...,  0.0087,  0.0066,  0.0056],
       device='cuda:0') -8.504830360412598 9.50642204284668
tensor([ 1.9057, -0.1473,  2.8506,  ..., -0.0490, -0.0552, -0.0524],
       device='cuda:0') -8.545642852783203 9.671435356140137
tensor([ 1.9137, -0.1535,  2.8553,  ..., -0.0439, -0.0427, -0.0408],
       device='cuda:0') -8.505207061767578 9.507359504699707
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:11<00:00,  1.16it/s]
Train loss: 11.645400905360779, Dist Loss: 909.5475022753079, Recon Loss: 5.777223079030713, FB Loss: 6.421536448970437, Time Loss: 0.22393500823333548
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:24<00:00,  2.16it/s]
Valid loss: 10.011225711305936, Dist Loss: 1440.6700201193491, Recon Loss: 4.933579359948635, FB Loss: 5.2200917753080525, Time Loss: 0.26098388837029535
Validation loss decreased (10.898012 --> 10.011226).  Saving model ...
tensor([ 1.4310, -0.0495,  2.7957,  ...,  0.0100,  0.0079,  0.0087],
       device='cuda:0') -7.4523186683654785 7.683740139007568
tensor([ 1.4220, -0.0607,  2.7855,  ..., -0.0363, -0.0479, -0.0442],
       device='cuda:0') -7.522731781005859 7.689703941345215
tensor([ 1.4226, -0.0606,  2.7865,  ..., -0.0390, -0.0392, -0.0361],
       device='cuda:0') -7.438127517700195 7.663851737976074
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:48<00:00,  1.15it/s]
Train loss: 10.873278213044008, Dist Loss: 710.5569638848305, Recon Loss: 5.401111260180672, FB Loss: 5.93280699973305, Time Loss: 0.1937086802868483
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:30<00:00,  2.13it/s]
Valid loss: 9.775907799601555, Dist Loss: 1186.0050494670868, Recon Loss: 4.828653651972612, FB Loss: 4.953864775846402, Time Loss: 0.24286176695022732
Validation loss decreased (10.011226 --> 9.775908).  Saving model ...
tensor([ 0.9578, -0.5783,  2.8369,  ...,  0.0235,  0.0211,  0.0207],
       device='cuda:0') -6.721719741821289 7.321552753448486
tensor([ 0.9559, -0.5790,  2.8390,  ..., -0.0378, -0.0494, -0.0470],
       device='cuda:0') -6.981023788452148 7.390726089477539
tensor([ 0.9553, -0.5791,  2.8390,  ..., -0.0578, -0.0593, -0.0568],
       device='cuda:0') -6.631802082061768 7.278562068939209
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:07<00:00,  1.16it/s]
Train loss: 10.491704359650612, Dist Loss: 554.612595140934, Recon Loss: 5.218121550480524, FB Loss: 5.756060554211339, Time Loss: 0.17064507469573678
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:27<00:00,  2.14it/s]
Valid loss: 9.669510022799175, Dist Loss: 1060.799195575714, Recon Loss: 4.781715051829815, FB Loss: 5.016387202839057, Time Loss: 0.22895731359021737
Validation loss decreased (9.775908 --> 9.669510).  Saving model ...
tensor([-0.1733, -0.2197,  1.7757,  ...,  0.0108,  0.0083,  0.0100],
       device='cuda:0') -7.4614996910095215 7.7859063148498535
tensor([-0.1784, -0.2280,  1.7659,  ..., -0.0337, -0.0437, -0.0407],
       device='cuda:0') -7.479323863983154 7.963334083557129
tensor([-0.1780, -0.2301,  1.7640,  ..., -0.0525, -0.0553, -0.0535],
       device='cuda:0') -7.4592061042785645 7.808992385864258
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:13<00:00,  1.16it/s]
Train loss: 10.115120753645897, Dist Loss: 447.32739821473757, Recon Loss: 5.035194012274345, FB Loss: 5.5458764780312775, Time Loss: 0.15984438452966668
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:27<00:00,  2.14it/s]
Valid loss: 9.143574201067288, Dist Loss: 870.2488075256348, Recon Loss: 4.5282746615509195, FB Loss: 4.712685882548491, Time Loss: 0.21730910037877038
Validation loss decreased (9.669510 --> 9.143574).  Saving model ...
tensor([-0.8710,  0.3585,  1.3486,  ...,  0.0133,  0.0127,  0.0110],
       device='cuda:0') -6.238108158111572 7.551738739013672
tensor([-0.8763,  0.3527,  1.3437,  ..., -0.0334, -0.0437, -0.0446],
       device='cuda:0') -6.340927600860596 7.538722038269043
tensor([-0.8788,  0.3503,  1.3393,  ..., -0.0422, -0.0443, -0.0462],
       device='cuda:0') -6.234398365020752 7.543661117553711
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:09<00:00,  1.14it/s]
Train loss: 9.77389853671193, Dist Loss: 370.6458771944046, Recon Loss: 4.8684169741968315, FB Loss: 5.291211085580289, Time Loss: 0.14972005399952953
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:24<00:00,  2.16it/s]
Valid loss: 8.84113343656063, Dist Loss: 753.7195854822795, Recon Loss: 4.382880735645691, FB Loss: 4.421194884677728, Time Loss: 0.1973016722709872
Validation loss decreased (9.143574 --> 8.841133).  Saving model ...
tensor([-1.0835,  0.2500,  1.4205,  ...,  0.0086,  0.0075,  0.0053],
       device='cuda:0') -5.528428077697754 7.302959442138672
tensor([-1.0860,  0.2464,  1.4177,  ..., -0.0270, -0.0371, -0.0381],
       device='cuda:0') -5.554981708526611 7.424488067626953
tensor([-1.0861,  0.2448,  1.4179,  ..., -0.0496, -0.0507, -0.0520],
       device='cuda:0') -5.5202317237854 7.309811115264893
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:16<00:00,  1.14it/s]
Train loss: 9.365256037190557, Dist Loss: 304.784146870176, Recon Loss: 4.667388810341557, FB Loss: 5.00730119968454, Time Loss: 0.14002097331200883
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:27<00:00,  2.14it/s]
Valid loss: 8.781802467505138, Dist Loss: 647.3782574653626, Recon Loss: 4.358532321701447, FB Loss: 4.332101971656084, Time Loss: 0.19106576319124238
Validation loss decreased (8.841133 --> 8.781802).  Saving model ...
tensor([-0.0060,  1.0296,  1.8135,  ...,  0.0180,  0.0103,  0.0147],
       device='cuda:0') -5.85380220413208 6.0468363761901855
tensor([-0.0138,  1.0275,  1.8139,  ..., -0.0333, -0.0469, -0.0417],
       device='cuda:0') -6.025270462036133 6.2173919677734375
tensor([-0.0260,  1.0161,  1.8046,  ..., -0.0285, -0.0358, -0.0316],
       device='cuda:0') -5.611748218536377 5.92308235168457
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:15<00:00,  1.16it/s]
Train loss: 9.174123248830437, Dist Loss: 259.5942268480857, Recon Loss: 4.57408191524446, FB Loss: 4.910876509174704, Time Loss: 0.13721333350598192
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:30<00:00,  2.13it/s]
Valid loss: 8.618503245711327, Dist Loss: 584.943243209521, Recon Loss: 4.280004461357991, FB Loss: 4.297931761542956, Time Loss: 0.2010490241557515
Validation loss decreased (8.781802 --> 8.618503).  Saving model ...
tensor([-0.9569, -0.0673,  0.5484,  ...,  0.0083,  0.0068,  0.0044],
       device='cuda:0') -5.3090009689331055 7.35120964050293
tensor([-0.9607, -0.0690,  0.5492,  ..., -0.0473, -0.0570, -0.0588],
       device='cuda:0') -5.519411087036133 7.400819778442383
tensor([-0.9671, -0.0767,  0.5414,  ..., -0.0489, -0.0483, -0.0496],
       device='cuda:0') -5.332222938537598 7.263833045959473
Epoch 12
 35%|█████████████████████████████████████████████████████████▍                                                                                                            | 1328/3840 [19:35<40:01,  1.05it/s]
 35%|█████████████████████████████████████████████████████████▌                                                                                                            | 1331/3840 [19:38<32:26,  1.29it/s]
 35%|█████████████████████████████████████████████████████████▌                                                                                                            | 1331/3840 [19:38<37:01,  1.13it/s]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 385, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 246, in train
    beginning = peak_norm(apply_augmentations(real_imgs, sample_rate=sample_rate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 160, in pitch_shift
    output = stretcher(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/transforms/_transforms.py", line 1110, in forward
    return F.phase_vocoder(complex_specgrams, rate, self.phase_advance)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/functional/functional.py", line 785, in phase_vocoder
    phase = phase - 2 * math.pi * torch.round(phase / (2 * math.pi))
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
^CTraceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 367, in <module>
    train_ds = AudioFileDataset(X_train, sequence_length, multiplier=training_params["dataset_multiplier"])
  File "/home/r/Documents/Projects/orpheus/orpheus/dataset.py", line 32, in __init__
    self.files[i] = torchaudio.load(inputs[i]["file"])
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/backend/soundfile_backend.py", line 230, in load
    waveform = file_.read(frames, dtype, always_2d=True)
  File "/home/r/.local/lib/python3.10/site-packages/soundfile.py", line 895, in read
    frames = self._array_io('read', out, frames)
  File "/home/r/.local/lib/python3.10/site-packages/soundfile.py", line 1344, in _array_io
    return self._cdata_io(action, cdata, ctype, frames)
  File "/home/r/.local/lib/python3.10/site-packages/soundfile.py", line 1353, in _cdata_io
    frames = func(self._file, data, frames)
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31108448
Learning rate: 0.00015
Parameter containing:
tensor([1., 1., 1.], device='cuda:0', requires_grad=True)
tensor(1., device='cuda:0') Parameter containing:
tensor(1., device='cuda:0', requires_grad=True)
tensor(1., device='cuda:0') Parameter containing:
tensor(5., device='cuda:0', requires_grad=True)
tensor(1., device='cuda:0') Parameter containing:
tensor(100., device='cuda:0', requires_grad=True)
Parameter containing:
tensor([1., 1., 1.], device='cuda:0', requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:08<00:00,  1.16it/s]
Train loss: 20.712612428267796, Dist Loss: 21959.8913371404, Recon Loss: 10.356306214133898, FB Loss: 10.390465606873233, Time Loss: 0.5027026541453475
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:03<00:00,  1.99it/s]
Valid loss: 14.366259869933128, Dist Loss: 18479.86297047933, Recon Loss: 7.090730624397596, FB Loss: 7.0826640193661055, Time Loss: 0.4978731777829429
Validation loss decreased (inf --> 14.366260).  Saving model ...
tensor([ 0.1001,  0.0978,  0.0967,  ..., -0.3158,  0.2449,  0.9282],
       device='cuda:0') -9.008539199829102 7.297327518463135
tensor([ 0.0367,  0.0354,  0.0404,  ..., -0.3359,  0.2210,  0.9022],
       device='cuda:0') -9.626226425170898 7.6370158195495605
tensor([ 0.0391,  0.0375,  0.0411,  ..., -0.3165,  0.2453,  0.9273],
       device='cuda:0') -8.917189598083496 7.2703657150268555
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:57<00:00,  1.12it/s]
Train loss: 14.330226275821527, Dist Loss: 6642.776641654968, Recon Loss: 7.131899254272382, FB Loss: 7.71927921709915, Time Loss: 0.38622576436803985
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:59<00:00,  2.00it/s]
Valid loss: 11.018581281105677, Dist Loss: 5693.198158772787, Recon Loss: 5.480824649333954, FB Loss: 5.585445063809554, Time Loss: 0.4229496175733705
Validation loss decreased (14.366260 --> 11.018581).  Saving model ...
tensor([ 0.1515,  0.1460,  0.1356,  ..., -0.3445,  0.0944,  0.7292],
       device='cuda:0') -8.059707641601562 7.58481502532959
tensor([ 0.0311,  0.0272,  0.0234,  ..., -0.4377, -0.0034,  0.6366],
       device='cuda:0') -8.672308921813965 8.027928352355957
tensor([ 0.0330,  0.0285,  0.0243,  ..., -0.3540,  0.0843,  0.7224],
       device='cuda:0') -7.987447738647461 7.330788612365723
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:56<00:00,  1.12it/s]
Train loss: 12.372393320749204, Dist Loss: 3174.3093094666797, Recon Loss: 6.170325110852718, FB Loss: 6.644885938242078, Time Loss: 0.3563669517597494
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:01<00:00,  1.99it/s]
Valid loss: 10.134197723865508, Dist Loss: 4505.182973798116, Recon Loss: 5.044572944442431, FB Loss: 5.118098044395447, Time Loss: 0.396267676865682
Validation loss decreased (11.018581 --> 10.134198).  Saving model ...
tensor([ 0.0123,  0.0032, -0.0086,  ..., -0.1385,  0.1586,  0.5555],
       device='cuda:0') -7.446870803833008 6.609739780426025
tensor([-0.0202, -0.0259, -0.0294,  ..., -0.2522,  0.0265,  0.4251],
       device='cuda:0') -8.012604713439941 7.0288920402526855
tensor([-0.0210, -0.0266, -0.0301,  ..., -0.2070,  0.0944,  0.5033],
       device='cuda:0') -7.373662948608398 6.430928707122803
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:57<00:00,  1.12it/s]
Train loss: 11.382184772690136, Dist Loss: 2419.0197787364323, Recon Loss: 5.678997285664082, FB Loss: 6.071459886680047, Time Loss: 0.32787627569632605
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:03<00:00,  1.98it/s]
Valid loss: 10.086518839001656, Dist Loss: 3784.611971918742, Recon Loss: 5.024336357414723, FB Loss: 4.907197299599647, Time Loss: 0.3648568688270946
Validation loss decreased (10.134198 --> 10.086519).  Saving model ...
tensor([0.0405, 0.0322, 0.0237,  ..., 0.0188, 0.1451, 0.3283], device='cuda:0') -6.936392307281494 5.769591331481934
tensor([-0.0231, -0.0303, -0.0307,  ..., -0.0447,  0.0735,  0.2533],
       device='cuda:0') -7.452103614807129 6.293163776397705
tensor([-0.0224, -0.0298, -0.0303,  ..., -0.0165,  0.1075,  0.2939],
       device='cuda:0') -6.875940322875977 5.716233253479004
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:11<00:00,  1.14it/s]
Train loss: 10.677434019992749, Dist Loss: 1940.9937767744063, Recon Loss: 5.329012038062016, FB Loss: 5.697346753502885, Time Loss: 0.29002075400203464
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:59<00:00,  2.00it/s]
Valid loss: 9.231245765586694, Dist Loss: 3225.7080428441363, Recon Loss: 4.599494338780642, FB Loss: 4.614356927573681, Time Loss: 0.32976895494696995
Validation loss decreased (10.086519 --> 9.231246).  Saving model ...
tensor([0.0688, 0.0622, 0.0469,  ..., 0.2138, 0.2255, 0.1734], device='cuda:0') -6.163473606109619 5.0666656494140625
tensor([0.0132, 0.0107, 0.0136,  ..., 0.1081, 0.1099, 0.0614], device='cuda:0') -6.873767375946045 5.63467264175415
tensor([0.0128, 0.0104, 0.0137,  ..., 0.1394, 0.1544, 0.1043], device='cuda:0') -6.088957786560059 5.0229082107543945
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:58<00:00,  1.12it/s]
Train loss: 10.250891810655594, Dist Loss: 1601.6280759692193, Recon Loss: 5.117437769969304, FB Loss: 5.463463941775262, Time Loss: 0.2577725329979633
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:02<00:00,  1.99it/s]
Valid loss: 9.150944262246291, Dist Loss: 2729.1058250427245, Recon Loss: 4.561826600134372, FB Loss: 4.520161833614111, Time Loss: 0.2997804983208577
Validation loss decreased (9.231246 --> 9.150944).  Saving model ...
tensor([ 0.0306,  0.0262,  0.0189,  ...,  0.3699,  0.2079, -0.0297],
       device='cuda:0') -5.456728458404541 5.154629230499268
tensor([ 0.0010, -0.0031, -0.0018,  ...,  0.2631,  0.0944, -0.1354],
       device='cuda:0') -6.076692581176758 5.647964000701904
tensor([ 0.0017, -0.0024, -0.0009,  ...,  0.3121,  0.1524, -0.0822],
       device='cuda:0') -5.34065580368042 4.929952621459961
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [57:04<00:00,  1.12it/s]
Train loss: 9.812524901454648, Dist Loss: 1316.634420633316, Recon Loss: 4.899679278644423, FB Loss: 5.228202134246628, Time Loss: 0.22654466585760627
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:02<00:00,  1.99it/s]
Valid loss: 8.982520455121994, Dist Loss: 2455.8674257278444, Recon Loss: 4.478980894635121, FB Loss: 4.357683547089497, Time Loss: 0.2749055028116951
Validation loss decreased (9.150944 --> 8.982520).  Saving model ...
tensor([ 0.0193,  0.0183,  0.0155,  ...,  0.5203,  0.1923, -0.1558],
       device='cuda:0') -4.137713432312012 4.069399356842041
tensor([ 0.0272,  0.0264,  0.0281,  ...,  0.4039,  0.0747, -0.2577],
       device='cuda:0') -4.842461109161377 4.428603649139404
tensor([ 0.0256,  0.0249,  0.0267,  ...,  0.4881,  0.1626, -0.1834],
       device='cuda:0') -4.109436511993408 4.000370502471924
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [55:42<00:00,  1.15it/s]
Train loss: 9.50476537918051, Dist Loss: 1112.4487401207289, Recon Loss: 4.746820447966456, FB Loss: 5.0580295295765, Time Loss: 0.20134548409453903
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:58<00:00,  2.01it/s]
Valid loss: 8.490138577918211, Dist Loss: 2058.402662086487, Recon Loss: 4.234777275969585, FB Loss: 4.171547274043163, Time Loss: 0.24849558904146155
Validation loss decreased (8.982520 --> 8.490139).  Saving model ...
tensor([ 0.0189,  0.0171,  0.0117,  ...,  0.5704,  0.1904, -0.2103],
       device='cuda:0') -3.2783777713775635 3.653439998626709
tensor([-0.0015, -0.0018, -0.0028,  ...,  0.4496,  0.0702, -0.3168],
       device='cuda:0') -3.8476364612579346 4.147005558013916
tensor([-0.0035, -0.0036, -0.0045,  ...,  0.5154,  0.1379, -0.2598],
       device='cuda:0') -3.25581693649292 3.5796875953674316
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:09<00:00,  1.14it/s]
Train loss: 9.241742482036353, Dist Loss: 937.0859882513682, Recon Loss: 4.616185811161995, FB Loss: 4.904518605768681, Time Loss: 0.17711864115359882
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:03<00:00,  1.98it/s]
Valid loss: 8.327421677609285, Dist Loss: 1917.9581895192464, Recon Loss: 4.154121043533086, FB Loss: 4.058881144970655, Time Loss: 0.225056953181047
Validation loss decreased (8.490139 --> 8.327422).  Saving model ...
tensor([ 2.0718e-03,  4.0891e-04, -2.8535e-03,  ...,  5.8365e-01,
         1.4381e-01, -3.3598e-01], device='cuda:0') -3.0439956188201904 3.3615596294403076
tensor([ 0.0025,  0.0019,  0.0016,  ...,  0.4569,  0.0296, -0.4243],
       device='cuda:0') -3.6843745708465576 3.774848461151123
tensor([ 4.3646e-04, -2.7985e-04, -5.5130e-04,  ...,  5.4259e-01,
         1.0497e-01, -3.7301e-01], device='cuda:0') -3.0007851123809814 3.23396372795105
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:52<00:00,  1.13it/s]
Train loss: 8.992595158393184, Dist Loss: 804.5053852001826, Recon Loss: 4.4922750523934765, FB Loss: 4.758120639684299, Time Loss: 0.1681804244639352
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:00<00:00,  2.00it/s]
Valid loss: 8.082923262814681, Dist Loss: 1681.246390914917, Recon Loss: 4.033055396378041, FB Loss: 3.9588590723772845, Time Loss: 0.22035179287195206
Validation loss decreased (8.327422 --> 8.082923).  Saving model ...
tensor([-0.0136, -0.0122, -0.0147,  ...,  0.5218,  0.1127, -0.3627],
       device='cuda:0') -2.898768901824951 3.0514514446258545
tensor([ 0.0031,  0.0045,  0.0037,  ...,  0.4537,  0.0604, -0.3919],
       device='cuda:0') -3.517998218536377 3.407698392868042
tensor([ 0.0023,  0.0038,  0.0029,  ...,  0.5060,  0.0972, -0.3779],
       device='cuda:0') -2.843552350997925 2.9914205074310303
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:33<00:00,  1.13it/s]
Train loss: 8.768635826806227, Dist Loss: 684.8336655497551, Recon Loss: 4.380893746763467, FB Loss: 4.65577597822994, Time Loss: 0.15798525975939506
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:03<00:00,  1.98it/s]
Valid loss: 8.058383446435133, Dist Loss: 1459.6118731339773, Recon Loss: 4.021893669168154, FB Loss: 3.942430615176757, Time Loss: 0.19887223119537037
Validation loss decreased (8.082923 --> 8.058383).  Saving model ...
tensor([ 0.0239,  0.0239,  0.0258,  ...,  0.4420,  0.1247, -0.3047],
       device='cuda:0') -2.2240564823150635 2.2497735023498535
tensor([-0.0055, -0.0066, -0.0041,  ...,  0.3399,  0.0370, -0.3716],
       device='cuda:0') -2.825734853744507 2.669800281524658
tensor([-0.0063, -0.0074, -0.0048,  ...,  0.4042,  0.0880, -0.3396],
       device='cuda:0') -2.1822662353515625 2.1947836875915527
Epoch 12
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:58<00:00,  1.12it/s]
Train loss: 8.586480125163993, Dist Loss: 598.5028875370821, Recon Loss: 4.290247545950114, FB Loss: 4.569440788775682, Time Loss: 0.13780504344613292
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:58<00:00,  2.01it/s]
Valid loss: 7.798885483046373, Dist Loss: 1286.0308327674866, Recon Loss: 3.893012586981058, FB Loss: 3.806010573108991, Time Loss: 0.19015872768165235
Validation loss decreased (8.058383 --> 7.798885).  Saving model ...
tensor([ 0.0667,  0.0665,  0.0675,  ...,  0.2435,  0.0751, -0.1578],
       device='cuda:0') -1.5529639720916748 1.5664246082305908
tensor([ 0.0116,  0.0104,  0.0132,  ...,  0.1449, -0.0068, -0.2196],
       device='cuda:0') -2.063544988632202 1.9687294960021973
tensor([ 0.0115,  0.0104,  0.0132,  ...,  0.1976,  0.0307, -0.2002],
       device='cuda:0') -1.4480620622634888 1.5039098262786865
Epoch 13
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:07<00:00,  1.14it/s]
Train loss: 8.409732927630346, Dist Loss: 525.6285193562508, Recon Loss: 4.202238323539495, FB Loss: 4.460783446455995, Time Loss: 0.12702372491379113
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:59<00:00,  2.00it/s]
Valid loss: 7.747077230612437, Dist Loss: 1213.2426709334056, Recon Loss: 3.8674724072217943, FB Loss: 3.7254831694066524, Time Loss: 0.17810872194143787
Validation loss decreased (7.798885 --> 7.747077).  Saving model ...
tensor([ 0.0247,  0.0268,  0.0262,  ...,  0.1184,  0.0393, -0.0706],
       device='cuda:0') -1.0341647863388062 1.164985179901123
tensor([-0.0061, -0.0023,  0.0008,  ...,  0.0078, -0.0595, -0.1597],
       device='cuda:0') -1.6002625226974487 1.5951803922653198
tensor([-0.0072, -0.0034, -0.0003,  ...,  0.0589, -0.0195, -0.1288],
       device='cuda:0') -0.9984809160232544 1.0242241621017456
Epoch 14
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:50<00:00,  1.13it/s]
Train loss: 8.276932852715253, Dist Loss: 483.5119594971339, Recon Loss: 4.13604886525621, FB Loss: 4.384730643344422, Time Loss: 0.12089111118499811
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:02<00:00,  1.99it/s]
Valid loss: 7.602773907780647, Dist Loss: 1085.5695204893748, Recon Loss: 3.7959591075778008, FB Loss: 3.6844001467029255, Time Loss: 0.17736520158068741
Validation loss decreased (7.747077 --> 7.602774).  Saving model ...
tensor([ 0.0010, -0.0026, -0.0061,  ...,  0.1008,  0.0522, -0.0128],
       device='cuda:0') -0.784012496471405 0.8778120875358582
tensor([-0.0074, -0.0100, -0.0105,  ...,  0.0398, -0.0011, -0.0599],
       device='cuda:0') -1.4087302684783936 1.4317792654037476
tensor([-0.0071, -0.0097, -0.0103,  ...,  0.0613,  0.0128, -0.0523],
       device='cuda:0') -0.7405650615692139 0.803753137588501
Epoch 15
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:22<00:00,  1.14it/s]
Train loss: 8.188976698368787, Dist Loss: 442.3546483139197, Recon Loss: 4.092276576347649, FB Loss: 4.336545010407765, Time Loss: 0.11892124710914989
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:02<00:00,  1.99it/s]
Valid loss: 7.635618722438812, Dist Loss: 1076.2414039134978, Recon Loss: 3.8124281535545985, FB Loss: 3.696886744101842, Time Loss: 0.1708771813578399
EarlyStopping counter: 1 out of 10
Epoch 16
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:55<00:00,  1.12it/s]
Train loss: 8.077582033599416, Dist Loss: 402.15228361288706, Recon Loss: 4.0367802560329435, FB Loss: 4.265824186863998, Time Loss: 0.1168830521106429
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:02<00:00,  1.99it/s]
Valid loss: 7.78091135819753, Dist Loss: 936.3125446160634, Recon Loss: 3.8857741167147952, FB Loss: 3.757990898688634, Time Loss: 0.1729344925498784
EarlyStopping counter: 2 out of 10
Epoch 17
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:36<00:00,  1.13it/s]
Train loss: 7.994103103379408, Dist Loss: 370.17420544624326, Recon Loss: 3.9952006803204614, FB Loss: 4.206104922729234, Time Loss: 0.11737459282909792
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [07:59<00:00,  2.00it/s]
Valid loss: 7.448748650153478, Dist Loss: 864.8999389330546, Recon Loss: 3.7200498225788277, FB Loss: 3.565249460438887, Time Loss: 0.18007509218004997
Validation loss decreased (7.602774 --> 7.448749).  Saving model ...
tensor([-0.0196, -0.0207, -0.0231,  ...,  0.0362,  0.0161, -0.0085],
       device='cuda:0') -0.5171529650688171 0.4631381034851074
tensor([ 0.0002,  0.0002,  0.0002,  ..., -0.0508, -0.0633, -0.0850],
       device='cuda:0') -1.2841262817382812 1.3017958402633667
tensor([-0.0005, -0.0005, -0.0005,  ..., -0.0358, -0.0551, -0.0788],
       device='cuda:0') -0.49576807022094727 0.4585473835468292
Epoch 18
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:30<00:00,  1.13it/s]
Train loss: 7.929553329075376, Dist Loss: 341.3812503794829, Recon Loss: 3.9630697585642336, FB Loss: 4.16319587683926, Time Loss: 0.11728587944210934
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:00<00:00,  2.00it/s]
Valid loss: 7.3535786335666975, Dist Loss: 846.5412258625031, Recon Loss: 3.6725566084186236, FB Loss: 3.531852479527394, Time Loss: 0.17614895545799905
Validation loss decreased (7.448749 --> 7.353579).  Saving model ...
tensor([-0.0069, -0.0076, -0.0098,  ...,  0.0346,  0.0218,  0.0037],
       device='cuda:0') -0.4363601505756378 0.42534491419792175
tensor([-0.0026, -0.0019, -0.0013,  ..., -0.0640, -0.0703, -0.0848],
       device='cuda:0') -1.2919639348983765 1.2495412826538086
tensor([-0.0030, -0.0024, -0.0018,  ..., -0.0320, -0.0446, -0.0614],
       device='cuda:0') -0.35499143600463867 0.3821423351764679
Epoch 19
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:43<00:00,  1.13it/s]
Train loss: 7.8719884943217036, Dist Loss: 319.6031478921572, Recon Loss: 3.9343962346514068, FB Loss: 4.1278917402649915, Time Loss: 0.11711290555637485
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:03<00:00,  1.99it/s]
Valid loss: 7.376425638298193, Dist Loss: 781.8167296091716, Recon Loss: 3.684303733954827, FB Loss: 3.557251841078202, Time Loss: 0.1793394351998965
EarlyStopping counter: 1 out of 10
Epoch 20
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:49<00:00,  1.13it/s]
Train loss: 7.8216214995831255, Dist Loss: 305.0824525197347, Recon Loss: 3.9092853386575976, FB Loss: 4.095487241012354, Time Loss: 0.11775428388403573
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:00<00:00,  2.00it/s]
Valid loss: 7.342003960907459, Dist Loss: 733.3948578278224, Recon Loss: 3.6673350078364213, FB Loss: 3.4891176270941893, Time Loss: 0.17417343494380474
Validation loss decreased (7.353579 --> 7.342004).  Saving model ...
tensor([-0.0174, -0.0200, -0.0199,  ...,  0.0043, -0.0015, -0.0005],
       device='cuda:0') -0.3387928307056427 0.3800533711910248
tensor([ 0.0043,  0.0018,  0.0027,  ..., -0.0919, -0.0932, -0.0902],
       device='cuda:0') -1.258588194847107 1.2357860803604126
tensor([ 0.0049,  0.0024,  0.0035,  ..., -0.0439, -0.0494, -0.0479],
       device='cuda:0') -0.3038454055786133 0.3546561300754547
Epoch 21
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:34<00:00,  1.13it/s]
Train loss: 7.767416448021929, Dist Loss: 287.38774359325566, Recon Loss: 3.882271283989151, FB Loss: 4.051123465225101, Time Loss: 0.11840400929625806
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:02<00:00,  1.99it/s]
Valid loss: 7.355785102148851, Dist Loss: 684.4384293715159, Recon Loss: 3.6744703595836956, FB Loss: 3.5196294715007146, Time Loss: 0.17199371213985917
EarlyStopping counter: 1 out of 10
Epoch 22
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [57:13<00:00,  1.12it/s]
Train loss: 7.721172143022219, Dist Loss: 263.9687826971213, Recon Loss: 3.859266226490339, FB Loss: 4.0288005188728375, Time Loss: 0.11743637740849712
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:02<00:00,  1.99it/s]
Valid loss: 7.141840904951096, Dist Loss: 662.3991638183594, Recon Loss: 3.5676084575553735, FB Loss: 3.4327722874780497, Time Loss: 0.17810374763721484
Validation loss decreased (7.342004 --> 7.141841).  Saving model ...
tensor([-0.0246, -0.0247, -0.0238,  ...,  0.0278,  0.0246,  0.0244],
       device='cuda:0') -0.36156123876571655 0.3910999596118927
tensor([-0.0009, -0.0017, -0.0009,  ..., -0.0778, -0.0773, -0.0775],
       device='cuda:0') -1.218577265739441 1.2233452796936035
tensor([-0.0010, -0.0018, -0.0009,  ..., -0.0526, -0.0571, -0.0566],
       device='cuda:0') -0.3546503782272339 0.39213988184928894
Epoch 23
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:49<00:00,  1.13it/s]
Train loss: 7.653186865399281, Dist Loss: 255.08239600559077, Recon Loss: 3.825318019775053, FB Loss: 3.9815480494871736, Time Loss: 0.11775855498708551
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:03<00:00,  1.98it/s]
Valid loss: 7.2730384414394695, Dist Loss: 586.5240518093109, Recon Loss: 3.6335866001745063, FB Loss: 3.4893418985108533, Time Loss: 0.17659597388434728
EarlyStopping counter: 1 out of 10
Epoch 24
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:24<00:00,  1.13it/s]
Train loss: 7.6157846581190825, Dist Loss: 236.8358185281356, Recon Loss: 3.8067081515987713, FB Loss: 3.962622011018296, Time Loss: 0.11855410560286449
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:29<00:00,  1.88it/s]
Valid loss: 7.183533552289009, Dist Loss: 591.8896461248398, Recon Loss: 3.588807329038779, FB Loss: 3.4200964726507666, Time Loss: 0.17700311402489508
EarlyStopping counter: 2 out of 10
Epoch 25
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:24<00:00,  1.13it/s]
Train loss: 7.597615981226166, Dist Loss: 235.5312877903382, Recon Loss: 3.7976303352663914, FB Loss: 3.949455339337389, Time Loss: 0.11825322989316192
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:09<00:00,  1.96it/s]
Valid loss: 7.095507741967837, Dist Loss: 556.1846092383067, Recon Loss: 3.5449729442596434, FB Loss: 3.3811033536990482, Time Loss: 0.17412690148630644
Validation loss decreased (7.141841 --> 7.095508).  Saving model ...
tensor([0.0041, 0.0044, 0.0030,  ..., 0.0184, 0.0179, 0.0147], device='cuda:0') -0.33612629771232605 0.38644811511039734
tensor([ 0.0012,  0.0020,  0.0025,  ..., -0.0739, -0.0700, -0.0720],
       device='cuda:0') -1.219954013824463 1.2408112287521362
tensor([-9.4007e-04, -8.9777e-05,  5.1488e-04,  ..., -7.3606e-02,
        -7.4031e-02, -7.4270e-02], device='cuda:0') -0.3597029149532318 0.3736368417739868
Epoch 26
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [57:02<00:00,  1.12it/s]
Train loss: 7.561908604328831, Dist Loss: 221.5960916707913, Recon Loss: 3.7798463199908534, FB Loss: 3.928528546728194, Time Loss: 0.11803058032674016
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:05<00:00,  1.98it/s]
Valid loss: 7.1749207690358165, Dist Loss: 537.8709894418716, Recon Loss: 3.584771028161049, FB Loss: 3.427062837531169, Time Loss: 0.17533920805484135
EarlyStopping counter: 1 out of 10
Epoch 27
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:58<00:00,  1.12it/s]
Train loss: 7.511583675444126, Dist Loss: 210.93680924475194, Recon Loss: 3.7547371524696547, FB Loss: 3.8951600219433504, Time Loss: 0.11759025634285838
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:05<00:00,  1.98it/s]
Valid loss: 7.139736776053906, Dist Loss: 479.3600760221481, Recon Loss: 3.5674715896447498, FB Loss: 3.3953227646648885, Time Loss: 0.1722729516593972
EarlyStopping counter: 2 out of 10
Epoch 28
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [57:15<00:00,  1.12it/s]
Train loss: 7.496118171637257, Dist Loss: 204.13152334690093, Recon Loss: 3.747038428299129, FB Loss: 3.8786749900629123, Time Loss: 0.11702862152839467
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:06<00:00,  1.97it/s]
Valid loss: 7.046262870728969, Dist Loss: 487.98270502885185, Recon Loss: 3.5206915229558944, FB Loss: 3.3381866842508314, Time Loss: 0.17719402931664566
Validation loss decreased (7.095508 --> 7.046263).  Saving model ...
tensor([-0.0213, -0.0195, -0.0190,  ...,  0.0187,  0.0166,  0.0155],
       device='cuda:0') -0.34793922305107117 0.3785698413848877
tensor([ 0.0002,  0.0008,  0.0004,  ..., -0.0863, -0.0833, -0.0839],
       device='cuda:0') -1.2438219785690308 1.1955134868621826
tensor([-0.0003,  0.0003, -0.0001,  ..., -0.0581, -0.0604, -0.0593],
       device='cuda:0') -0.35154277086257935 0.3590724766254425
Epoch 29
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:33<00:00,  1.13it/s]
Train loss: 7.470332115267714, Dist Loss: 195.84452276130517, Recon Loss: 3.734186834221085, FB Loss: 3.8737346254910032, Time Loss: 0.11833429089650356
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:05<00:00,  1.98it/s]
Valid loss: 7.112363197902838, Dist Loss: 478.61538915634156, Recon Loss: 3.553788520147403, FB Loss: 3.387208924939235, Time Loss: 0.17688512318854918
EarlyStopping counter: 1 out of 10
Epoch 30
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:28<00:00,  1.13it/s]
Train loss: 7.431549400587877, Dist Loss: 185.66980012357234, Recon Loss: 3.7148463505630693, FB Loss: 3.840226987066368, Time Loss: 0.11787985633030379
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:08<00:00,  1.96it/s]
Valid loss: 7.05482462644577, Dist Loss: 480.74056278864543, Recon Loss: 3.5250086074074107, FB Loss: 3.3347540122767287, Time Loss: 0.17463990713270808
EarlyStopping counter: 2 out of 10
Epoch 31
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:23<00:00,  1.13it/s]
Train loss: 7.403637393812338, Dist Loss: 176.9030220657587, Recon Loss: 3.700934181672831, FB Loss: 3.8267454757665593, Time Loss: 0.11846881397965868
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:06<00:00,  1.97it/s]
Valid loss: 7.1806712384025255, Dist Loss: 427.1817204872767, Recon Loss: 3.5881997187932333, FB Loss: 3.4375954451660315, Time Loss: 0.17234694642465911
EarlyStopping counter: 3 out of 10
Epoch 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [56:32<00:00,  1.13it/s]
Train loss: 7.364274938280384, Dist Loss: 189.48786049485207, Recon Loss: 3.6811900306493044, FB Loss: 3.796025151138504, Time Loss: 0.11781082931217195
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:09<00:00,  1.96it/s]
Valid loss: 7.124762364725272, Dist Loss: 548.4273185253144, Recon Loss: 3.559639049569766, FB Loss: 3.356346317380667, Time Loss: 0.17947336428648367
EarlyStopping counter: 4 out of 10
Epoch 33
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [57:03<00:00,  1.12it/s]
Train loss: 7.363695126771927, Dist Loss: 195.80898068944614, Recon Loss: 3.6808685186629493, FB Loss: 3.79711654043446, Time Loss: 0.11797666302954894
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:10<00:00,  1.96it/s]
Valid loss: 6.9049635196725525, Dist Loss: 458.03743900458016, Recon Loss: 3.4501915705700714, FB Loss: 3.2620983727276327, Time Loss: 0.17619471508975645
Validation loss decreased (7.046263 --> 6.904964).  Saving model ...
tensor([-0.0115, -0.0118, -0.0106,  ...,  0.0089,  0.0070,  0.0072],
       device='cuda:0') -0.3317467272281647 0.3641906678676605
tensor([-0.0030, -0.0036, -0.0024,  ..., -0.0952, -0.0902, -0.0885],
       device='cuda:0') -1.2735750675201416 1.2779024839401245
tensor([-0.0051, -0.0057, -0.0044,  ..., -0.0860, -0.0857, -0.0823],
       device='cuda:0') -0.36673182249069214 0.3791927099227905
Epoch 34
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3840/3840 [57:22<00:00,  1.12it/s]
Train loss: 7.343699732422829, Dist Loss: 177.9234025756518, Recon Loss: 3.6709602502485117, FB Loss: 3.786714225200315, Time Loss: 0.1174090542384268
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 960/960 [08:09<00:00,  1.96it/s]
Valid loss: 6.964150296151638, Dist Loss: 412.9819592396418, Recon Loss: 3.4800102380414804, FB Loss: 3.308993742366632, Time Loss: 0.17232926018477884
EarlyStopping counter: 1 out of 10
Epoch 35
  3%|█████▌                                                                                                                                                               | 128/3840 [01:59<1:04:56,  1.05s/it]
  3%|█████▌                                                                                                                                                                 | 128/3840 [02:00<58:12,  1.06it/s]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 385, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 246, in train
    beginning = peak_norm(apply_augmentations(real_imgs, sample_rate=sample_rate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 160, in pitch_shift
    output = stretcher(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/transforms/_transforms.py", line 1110, in forward
    return F.phase_vocoder(complex_specgrams, rate, self.phase_advance)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/functional/functional.py", line 789, in phase_vocoder
    phase = torch.cat([phase_0, phase[..., :-1]], dim=-1)
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$
