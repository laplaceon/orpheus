r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
  8%|████████████▋                                                                                                                                                          | 200/2640 [03:25<32:37,  1.25it/s]
  8%|████████████▋                                                                                                                                                          | 200/2640 [03:26<42:00,  1.03s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 503, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 381, in train
    beginning = peak_norm(apply_augmentations_adv(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 162, in pitch_shift
    output = resampler(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1494, in _call_impl
    def _call_impl(self, *args, **kwargs):
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2640/2640 [46:09<00:00,  1.05s/it]
Train loss: 8.30685340163552, Disc Loss: 32.01253551136364, Adv Loss: -0.1964967409769694, Recon Loss: 5.111741030848387, Time Loss: 0.24162174089614188
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 660/660 [07:42<00:00,  1.43it/s]
Valid loss: 8.440084504358696, Dist Loss: 0.0, Recon Loss: 4.220042252179348, Time Loss: 0.2673638183510665
Validation loss decreased (9.812762 --> 8.440085).  Saving model ...
tensor([0.0327, 0.0406, 0.0336,  ..., 0.0208, 0.0192, 0.0179], device='cuda:0') -0.32286426424980164 0.34832409024238586
tensor([ 0.0008, -0.0022, -0.0024,  ..., -0.0429, -0.0568, -0.0633],
       device='cuda:0') -1.2676724195480347 1.3070688247680664
tensor([ 0.0139,  0.0111,  0.0110,  ..., -0.0097, -0.0109, -0.0108],
       device='cuda:0') -0.3305648863315582 0.27286869287490845
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2640/2640 [46:17<00:00,  1.05s/it]
Train loss: 8.162317544492808, Disc Loss: 31.99569128787879, Adv Loss: -0.013211423700506037, Recon Loss: 4.125388509757591, Time Loss: 0.21827939114053593
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 660/660 [07:33<00:00,  1.46it/s]
Valid loss: 7.825671598405549, Dist Loss: 0.0, Recon Loss: 3.9128357992027745, Time Loss: 0.2704521150017778
Validation loss decreased (8.440085 --> 7.825672).  Saving model ...
tensor([0.0268, 0.0375, 0.0331,  ..., 0.0206, 0.0194, 0.0181], device='cuda:0') -0.40995606780052185 0.3680426776409149
tensor([ 0.0059,  0.0085,  0.0093,  ..., -0.0918, -0.0911, -0.0854],
       device='cuda:0') -1.348263144493103 1.4123586416244507
tensor([ 0.0133,  0.0162,  0.0168,  ..., -0.0243, -0.0223, -0.0185],
       device='cuda:0') -0.35113561153411865 0.3171335756778717
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2640/2640 [46:29<00:00,  1.06s/it]
Train loss: 8.104812048962621, Disc Loss: 32.00015980113636, Adv Loss: 0.00660173242742365, Recon Loss: 3.997488190820723, Time Loss: 0.21902704549896898
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 660/660 [07:43<00:00,  1.42it/s]
Valid loss: 7.843350757974567, Dist Loss: 0.0, Recon Loss: 3.9216753789872834, Time Loss: 0.2599683430045843
EarlyStopping counter: 1 out of 10
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2640/2640 [46:37<00:00,  1.06s/it]
Train loss: 6.64955260404809, Disc Loss: 32.00277580492424, Adv Loss: -0.13645027045047645, Recon Loss: 3.984932998635552, Time Loss: 0.22083013446042032
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 660/660 [07:40<00:00,  1.43it/s]
Valid loss: 8.772047274040453, Dist Loss: 0.0, Recon Loss: 4.386023637020227, Time Loss: 0.2572243259485924
EarlyStopping counter: 2 out of 10
Epoch 5
  0%|▏                                                                                                                                                                      | 3/2640 [00:06<1:25:59,  1.96s/it]
  0%|▏                                                                                                                                                                      | 3/2640 [00:08<2:08:07,  2.92s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 500, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 398, in train

  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 157, in forward_wd
    fb_dist = self.distance(y, x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/Documents/Projects/orpheus/orpheus/core/loss.py", line 177, in forward
    stfts_x = self.multiscale_stft(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/Documents/Projects/orpheus/orpheus/core/loss.py", line 101, in forward
    y = mel(y)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/Documents/Projects/orpheus/orpheus/core/loss.py", line 53, in forward
    y = torch.einsum('bft,mf->bmt', x, mel)
  File "/usr/local/lib/python3.10/dist-packages/torch/functional.py", line 378, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
  0%|▋                                                                                                                                                                       | 10/2640 [00:16<33:01,  1.33it/s]
  0%|▋                                                                                                                                                                     | 10/2640 [00:17<1:16:05,  1.74s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 500, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 380, in train
    beginning = peak_norm(apply_augmentations_adv(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 160, in pitch_shift
    output = stretcher(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/transforms/_transforms.py", line 1110, in forward
    return F.phase_vocoder(complex_specgrams, rate, self.phase_advance)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/functional/functional.py", line 778, in phase_vocoder
    angle_0 = complex_specgrams_0.angle()
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2640/2640 [44:46<00:00,  1.02s/it]
Train loss: 7.807155473665758, Disc Loss: 31.957581676136364, Adv Loss: -0.5581743933937766, FM Loss: 0.029566449830026337, Recon Loss: 4.034831911596385, Time Loss: 0.22172046265931744
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 660/660 [07:20<00:00,  1.50it/s]
Valid loss: 8.028532441457113, Dist Loss: 0.0, Recon Loss: 4.014266220728556, Time Loss: 0.27618066337185376
Validation loss decreased (9.812762 --> 8.028532).  Saving model ...
tensor([0.0248, 0.0322, 0.0306,  ..., 0.0173, 0.0193, 0.0203], device='cuda:0') -0.35174018144607544 0.3384561836719513
tensor([ 0.0066,  0.0069,  0.0076,  ..., -0.0714, -0.0673, -0.0614],
       device='cuda:0') -1.354493498802185 1.5188517570495605
tensor([ 0.0087,  0.0102,  0.0114,  ..., -0.0337, -0.0298, -0.0254],
       device='cuda:0') -0.3455899655818939 0.32361483573913574
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2640/2640 [44:08<00:00,  1.00s/it]
Train loss: 7.469460947766448, Disc Loss: 31.916844223484848, Adv Loss: -0.6371238939689867, FM Loss: 0.024184799194335936, Recon Loss: 3.9323683205879094, Time Loss: 0.22133485109291293
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 660/660 [07:21<00:00,  1.50it/s]
Valid loss: 8.05533258264715, Dist Loss: 0.0, Recon Loss: 4.027666291323575, Time Loss: 0.2738868333399296
EarlyStopping counter: 1 out of 10
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2640/2640 [44:23<00:00,  1.01s/it]
Train loss: 7.550810210090695, Disc Loss: 31.99992305871212, Adv Loss: -0.7275200843811035, FM Loss: 0.025895110043612394, Recon Loss: 4.009690380096435, Time Loss: 0.22323761111633345
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 660/660 [07:23<00:00,  1.49it/s]
Valid loss: 8.093024451804883, Dist Loss: 0.0, Recon Loss: 4.0465122259024415, Time Loss: 0.270692277581177
EarlyStopping counter: 2 out of 10
Epoch 4
  1%|██▍                                                                                                                                                                     | 38/2640 [00:37<42:56,  1.01it/s]
  1%|██▍                                                                                                                                                                     | 38/2640 [00:37<43:17,  1.00it/s]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 501, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 381, in train
    beginning = peak_norm(apply_augmentations_adv(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 160, in pitch_shift
    output = stretcher(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/transforms/_transforms.py", line 1110, in forward
    return F.phase_vocoder(complex_specgrams, rate, self.phase_advance)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/functional/functional.py", line 776, in phase_vocoder
    complex_specgrams_1 = complex_specgrams.index_select(-1, (time_steps + 1).long())
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:23:44<00:00,  1.40it/s]
Train loss: 9.026149602640759, Disc Loss: 19.66566495028409, Adv Loss: 0.6670882723548196, FM Loss: 0.027955344319343566, Recon Loss: 4.0397545453161, Time Loss: 0.2235485569653313
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [08:02<00:00,  3.65it/s]
Valid loss: 8.063317872719331, Dist Loss: 0.0, Recon Loss: 4.0316589363596655, Time Loss: 0.272708387481345
Validation loss decreased (9.812762 --> 8.063318).  Saving model ...
tensor([-0.0104, -0.0057, -0.0094,  ...,  0.0261,  0.0261,  0.0258],
       device='cuda:0') -0.33285051584243774 0.3405276834964752
tensor([-0.0308, -0.0311, -0.0319,  ..., -0.0363, -0.0397, -0.0409],
       device='cuda:0') -1.3243449926376343 1.5479029417037964
tensor([-0.0273, -0.0272, -0.0281,  ..., -0.0019, -0.0005,  0.0011],
       device='cuda:0') -0.334500253200531 0.3461690843105316
Epoch 2
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:23:15<00:00,  1.41it/s]
Train loss: 10.136658687686378, Disc Loss: 18.563850541548295, Adv Loss: 1.1622682343829762, FM Loss: 0.07621519999070601, Recon Loss: 4.106119385124607, Time Loss: 0.2251359203713946
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:58<00:00,  3.68it/s]
Valid loss: 8.208640930869363, Dist Loss: 0.0, Recon Loss: 4.104320465434681, Time Loss: 0.2701211738410744
EarlyStopping counter: 1 out of 10
Epoch 3
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:23:20<00:00,  1.41it/s]
Train loss: 11.292855593291195, Disc Loss: 17.310240589488636, Adv Loss: 1.6553483897989447, FM Loss: 0.12210246866399592, Recon Loss: 4.2082446649331935, Time Loss: 0.22515827819800258
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [08:00<00:00,  3.67it/s]
Valid loss: 8.116545049168847, Dist Loss: 0.0, Recon Loss: 4.058272524584424, Time Loss: 0.2707363853876648
EarlyStopping counter: 2 out of 10
Epoch 4
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:22:58<00:00,  1.41it/s]
Train loss: 12.220686577531424, Disc Loss: 16.400736305930398, Adv Loss: 2.02975680177862, FM Loss: 0.16167774200439453, Recon Loss: 4.287073839083314, Time Loss: 0.22428274864584885
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:58<00:00,  3.68it/s]
Valid loss: 8.442687203396451, Dist Loss: 0.0, Recon Loss: 4.2213436016982255, Time Loss: 0.2687606776799922
EarlyStopping counter: 3 out of 10
Epoch 5
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:22:47<00:00,  1.42it/s]
Train loss: 13.48729508099231, Disc Loss: 15.50366543856534, Adv Loss: 2.6991733160885896, FM Loss: 0.20173651088367808, Recon Loss: 4.385378041457046, Time Loss: 0.22526291031178763
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:55<00:00,  3.70it/s]
Valid loss: 8.476956858147274, Dist Loss: 0.0, Recon Loss: 4.238478429073637, Time Loss: 0.27187045129989695
EarlyStopping counter: 4 out of 10
Epoch 6
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:23:30<00:00,  1.41it/s]
Train loss: 14.433185038241474, Disc Loss: 15.008820689808239, Adv Loss: 3.1477858716791327, FM Loss: 0.22683379433371803, Recon Loss: 4.508536333523013, Time Loss: 0.22460976102579894
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:59<00:00,  3.67it/s]
Valid loss: 8.256259749423373, Dist Loss: 0.0, Recon Loss: 4.128129874711687, Time Loss: 0.27070746571883897
EarlyStopping counter: 5 out of 10
Epoch 7
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:23:41<00:00,  1.40it/s]
Train loss: 15.15617014169693, Disc Loss: 14.534794477982954, Adv Loss: 3.4966814214533026, FM Loss: 0.25279457785866477, Recon Loss: 4.565774210508574, Time Loss: 0.22548997403196566
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [07:56<00:00,  3.69it/s]
Valid loss: 9.065910401398485, Dist Loss: 0.0, Recon Loss: 4.532955200699242, Time Loss: 0.26866171626077795
EarlyStopping counter: 6 out of 10
Epoch 8
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7040/7040 [1:23:16<00:00,  1.41it/s]
Train loss: 15.70311258055947, Disc Loss: 14.184201882102272, Adv Loss: 3.8425784891301937, FM Loss: 0.2734307896007191, Recon Loss: 4.563114502992143, Time Loss: 0.22570073800267312
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1760/1760 [08:00<00:00,  3.66it/s]
Valid loss: 9.209154095432975, Dist Loss: 0.0, Recon Loss: 4.604577047716488, Time Loss: 0.2731735608233562
EarlyStopping counter: 7 out of 10
Epoch 9
  8%|█████████████                                                                                                                                                        | 559/7040 [06:41<1:19:24,  1.36it/s]
  8%|█████████████                                                                                                                                                        | 559/7040 [06:42<1:17:41,  1.39it/s]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 501, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 381, in train
    beginning = peak_norm(apply_augmentations_adv(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 161, in pitch_shift
    output = torch.istft(output[0], n_fft, hop_length)
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
  1%|▉                                                                                                                                                                     | 42/7040 [00:32<1:49:54,  1.06it/s]
  1%|▉                                                                                                                                                                     | 42/7040 [00:32<1:31:27,  1.28it/s]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 501, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 423, in train
    scaler.scale(loss).backward()
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/usr/local/lib/python3.10/dist-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5280/5280 [1:18:58<00:00,  1.11it/s]
Train loss: 8.194271289128245, Disc Loss: 9.919377367424243, Adv Loss: 0.23073429772348114, FM Loss: 0.01769428469917991, Recon Loss: 3.89329696884661, Time Loss: 0.2234414337132352
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1320/1320 [07:24<00:00,  2.97it/s]
Valid loss: 7.845437751394329, Dist Loss: 0.0, Recon Loss: 3.9227188756971647, Time Loss: 0.27470604988577013
Validation loss decreased (9.812762 --> 7.845438).  Saving model ...
tensor([0.0460, 0.0586, 0.0583,  ..., 0.0290, 0.0290, 0.0290], device='cuda:0') -0.36239296197891235 0.35257869958877563
tensor([ 0.0062,  0.0069,  0.0086,  ..., -0.0088, -0.0261, -0.0377],
       device='cuda:0') -1.293187141418457 1.4608162641525269
tensor([0.0072, 0.0086, 0.0097,  ..., 0.0038, 0.0055, 0.0081], device='cuda:0') -0.4596472680568695 0.37454238533973694
Epoch 2
 21%|███████████████████████████████████▎                                                                                                                                | 1135/5280 [17:09<1:03:55,  1.08it/s]
