r@Azumith:~$ cd Documents/Projects/orpheus/orpheus/
r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.0001
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
  2%|███                                                                                                                                                                     | 42/2347 [00:52<30:31,  1.26it/s]
  2%|███                                                                                                                                                                     | 42/2347 [00:53<48:32,  1.26s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 515, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 389, in train
    beginning = peak_norm(apply_augmentations_adv(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 160, in pitch_shift
    output = stretcher(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/transforms/_transforms.py", line 1110, in forward
    return F.phase_vocoder(complex_specgrams, rate, self.phase_advance)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/functional/functional.py", line 782, in phase_vocoder
    norm_1 = complex_specgrams_1.abs()
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:14<00:00,  1.13s/it]
Train loss: 9.290187989288967, Disc Loss: 15.99406822539412, Adv Loss: 0.053187847746957555, FM Loss: 0.07575947810702492, Recon Loss: 3.8609071630186156, Time Loss: 0.2215682208430122
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:23<00:00,  1.32it/s]
Valid loss: 7.830944193688934, Dist Loss: 0.0, Recon Loss: 3.8886211803865187, Time Loss: 0.268509147165175
Validation loss decreased (inf --> 7.830944).  Saving model ...
tensor([0.0316, 0.0407, 0.0401,  ..., 0.0267, 0.0280, 0.0277], device='cuda:0') -0.33200323581695557 0.33551692962646484
tensor([ 0.0015,  0.0032,  0.0065,  ..., -0.0413, -0.0446, -0.0481],
       device='cuda:0') -1.3239737749099731 1.315079689025879
tensor([ 0.0056,  0.0076,  0.0101,  ..., -0.0014,  0.0017,  0.0035],
       device='cuda:0') -0.3673444092273712 0.38395941257476807
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:38<00:00,  1.14s/it]
Train loss: 9.224197893179271, Disc Loss: 15.988672374307626, Adv Loss: 0.23102646621684597, FM Loss: 0.06826090477454597, Recon Loss: 3.8139809050557965, Time Loss: 0.22094803313956038
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:17<00:00,  1.34it/s]
Valid loss: 7.576505453054502, Dist Loss: 0.0, Recon Loss: 3.7615095500848565, Time Loss: 0.267431743398588
Validation loss decreased (7.830944 --> 7.576505).  Saving model ...
tensor([0.0316, 0.0400, 0.0371,  ..., 0.0270, 0.0274, 0.0274], device='cuda:0') -0.3386067748069763 0.3509819209575653
tensor([ 0.0048,  0.0054,  0.0064,  ..., -0.0186, -0.0341, -0.0467],
       device='cuda:0') -1.3267804384231567 1.3726961612701416
tensor([ 0.0063,  0.0069,  0.0074,  ..., -0.0066, -0.0065, -0.0055],
       device='cuda:0') -0.3664657175540924 0.46749621629714966
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:10<00:00,  1.15s/it]
Train loss: 9.309504598772774, Disc Loss: 15.988376118449084, Adv Loss: 0.1540299404617264, FM Loss: 0.07718414319643428, Recon Loss: 3.805894487707677, Time Loss: 0.220912146505443
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:23<00:00,  1.32it/s]
Valid loss: 7.604316654562747, Dist Loss: 0.0, Recon Loss: 3.7755112493667733, Time Loss: 0.2664707883164363
EarlyStopping counter: 1 out of 10
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:46<00:00,  1.14s/it]
Train loss: 9.660638467474191, Disc Loss: 15.986611898167874, Adv Loss: 0.2595365546234222, FM Loss: 0.0898000085714476, Recon Loss: 3.8025534691381924, Time Loss: 0.22079861267899573
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:18<00:00,  1.34it/s]
Valid loss: 7.545857834044266, Dist Loss: 0.0, Recon Loss: 3.745648531125798, Time Loss: 0.2728038348917559
Validation loss decreased (7.576505 --> 7.545858).  Saving model ...
tensor([0.0468, 0.0574, 0.0566,  ..., 0.0182, 0.0192, 0.0191], device='cuda:0') -0.3560328185558319 0.3725443184375763
tensor([ 0.0054,  0.0068,  0.0074,  ..., -0.0235, -0.0192, -0.0151],
       device='cuda:0') -1.3592697381973267 1.3698099851608276
tensor([ 0.0056,  0.0073,  0.0076,  ..., -0.0080, -0.0052, -0.0027],
       device='cuda:0') -0.39593565464019775 0.5019771456718445
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:29<00:00,  1.14s/it]
Train loss: 9.759157080827087, Disc Loss: 15.98557666702173, Adv Loss: 0.17791591525636535, FM Loss: 0.09760898481189417, Recon Loss: 3.814524514552223, Time Loss: 0.22085907765472498
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:21<00:00,  1.33it/s]
Valid loss: 7.653421404414527, Dist Loss: 0.0, Recon Loss: 3.7998548130769745, Time Loss: 0.2685589286002126
EarlyStopping counter: 1 out of 10
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:49<00:00,  1.15s/it]
Train loss: 9.953175057133665, Disc Loss: 15.985546708564124, Adv Loss: 0.11126066239580074, FM Loss: 0.11208787876644387, Recon Loss: 3.8000835591191477, Time Loss: 0.22042237358698705
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:15<00:00,  1.35it/s]
Valid loss: 7.594034236375071, Dist Loss: 0.0, Recon Loss: 3.7700682405312587, Time Loss: 0.26948883758899095
EarlyStopping counter: 2 out of 10
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:46<00:00,  1.14s/it]
Train loss: 10.357295278086783, Disc Loss: 15.984534778440562, Adv Loss: 0.34364275450801973, FM Loss: 0.12165359867650191, Recon Loss: 3.790295059852616, Time Loss: 0.22183407392014734
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:21<00:00,  1.33it/s]
Valid loss: 7.647282529730203, Dist Loss: 0.0, Recon Loss: 3.796510782518013, Time Loss: 0.27130486028589423
EarlyStopping counter: 3 out of 10
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:43<00:00,  1.14s/it]
Train loss: 11.19677261560584, Disc Loss: 15.974598556668086, Adv Loss: 0.43175464170152805, FM Loss: 0.1587948825545244, Recon Loss: 3.794560110919466, Time Loss: 0.2207438358961647
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:17<00:00,  1.34it/s]
Valid loss: 7.614353186430273, Dist Loss: 0.0, Recon Loss: 3.7802131444063463, Time Loss: 0.26963448780231825
EarlyStopping counter: 4 out of 10
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:45<00:00,  1.14s/it]
Train loss: 11.759100050127754, Disc Loss: 15.974558612057946, Adv Loss: 0.5880012008348423, FM Loss: 0.1747541846140019, Recon Loss: 3.838008098720133, Time Loss: 0.21956227234400838
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:22<00:00,  1.33it/s]
Valid loss: 8.138010349956039, Dist Loss: 0.0, Recon Loss: 4.044756367015676, Time Loss: 0.242488053514665
EarlyStopping counter: 5 out of 10
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:16<00:00,  1.16s/it]
Train loss: 10.754500669065719, Disc Loss: 15.963107823817639, Adv Loss: 0.5722859581328474, FM Loss: 0.125458946926928, Recon Loss: 3.8365128925113816, Time Loss: 0.11727470398253972
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:18<00:00,  1.34it/s]
Valid loss: 7.802594585353715, Dist Loss: 0.0, Recon Loss: 3.8878997464805485, Time Loss: 0.1339754755251757
EarlyStopping counter: 6 out of 10
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:36<00:00,  1.17s/it]
Train loss: 10.759901963450526, Disc Loss: 15.9534944876438, Adv Loss: 0.6060771812110644, FM Loss: 0.12895930143534298, Recon Loss: 3.787327698864833, Time Loss: 0.10860347687645724
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:23<00:00,  1.32it/s]
Valid loss: 7.49893069632821, Dist Loss: 0.0, Recon Loss: 3.736438951053652, Time Loss: 0.1302639549404535
Validation loss decreased (7.545858 --> 7.498931).  Saving model ...
tensor([-0.0009,  0.0068,  0.0024,  ..., -0.0229, -0.0217, -0.0208],
       device='cuda:0') -0.3711308538913727 0.33024653792381287
tensor([-0.0066, -0.0069, -0.0072,  ..., -0.0499, -0.0411, -0.0338],
       device='cuda:0') -1.3196382522583008 1.1523483991622925
tensor([-0.0068, -0.0069, -0.0070,  ..., -0.0270, -0.0260, -0.0239],
       device='cuda:0') -0.3995734453201294 0.37769898772239685
Epoch 12
  9%|███████████████▋                                                                                                                                                       | 221/2347 [04:12<34:48,  1.02it/s]
  9%|███████████████▋                                                                                                                                                       | 221/2347 [04:15<41:00,  1.16s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 515, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 431, in train
    scaler.scale(loss).backward()
  File "/usr/local/lib/python3.10/dist-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/usr/local/lib/python3.10/dist-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 7.49893069632821
Resuming from disc checkpoint
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:56<00:00,  1.20s/it]
Train loss: 10.876921216528315, Disc Loss: 15.946371032168726, Adv Loss: 0.6024549148618082, FM Loss: 0.1351640568827892, Recon Loss: 3.7855874334033826, Time Loss: 0.10854380528756441
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:52<00:00,  1.24it/s]
Valid loss: 7.596841994095499, Dist Loss: 0.0, Recon Loss: 3.7852377989020014, Time Loss: 0.13183200394249248
EarlyStopping counter: 1 out of 10
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:43<00:00,  1.19s/it]
Train loss: 11.061149842189534, Disc Loss: 15.948641217511717, Adv Loss: 0.7212338051391654, FM Loss: 0.13945407160404238, Recon Loss: 3.7754211500953705, Time Loss: 0.10829717091165252
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.485379287290817, Dist Loss: 0.0, Recon Loss: 3.7295798804528464, Time Loss: 0.1310976313766619
Validation loss decreased (7.498931 --> 7.485379).  Saving model ...
tensor([-0.0112, -0.0046, -0.0078,  ..., -0.0200, -0.0190, -0.0174],
       device='cuda:0') -0.38467690348625183 0.31858354806900024
tensor([-0.0196, -0.0195, -0.0193,  ..., -0.0341, -0.0330, -0.0266],
       device='cuda:0') -1.3138821125030518 1.2911906242370605
tensor([-0.0146, -0.0144, -0.0143,  ..., -0.0097, -0.0112, -0.0102],
       device='cuda:0') -0.39745521545410156 0.3768036365509033
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:42<00:00,  1.19s/it]
Train loss: 11.10142553091354, Disc Loss: 15.946351059863655, Adv Loss: 0.7069286513846633, FM Loss: 0.1421097380382536, Recon Loss: 3.776159016487697, Time Loss: 0.10757529980954994
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:48<00:00,  1.25it/s]
Valid loss: 7.738644303414444, Dist Loss: 0.0, Recon Loss: 3.8562234101953456, Time Loss: 0.13098744084991934
EarlyStopping counter: 1 out of 10
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:23<00:00,  1.19s/it]
Train loss: 10.963420865075559, Disc Loss: 15.945229282062208, Adv Loss: 0.5640046323265072, FM Loss: 0.14408413562360195, Recon Loss: 3.75887523359779, Time Loss: 0.10773050144606822
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:48<00:00,  1.25it/s]
Valid loss: 7.484338238048391, Dist Loss: 0.0, Recon Loss: 3.7290888531244595, Time Loss: 0.13080266657169573
Validation loss decreased (7.485379 --> 7.484338).  Saving model ...
tensor([ 0.0035,  0.0099,  0.0040,  ..., -0.0249, -0.0230, -0.0208],
       device='cuda:0') -0.3496522903442383 0.3705415725708008
tensor([ 0.0091,  0.0079,  0.0066,  ..., -0.0488, -0.0517, -0.0441],
       device='cuda:0') -1.261771559715271 1.5476089715957642
tensor([ 0.0096,  0.0092,  0.0079,  ..., -0.0180, -0.0184, -0.0166],
       device='cuda:0') -0.38200706243515015 0.466590017080307
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:12<00:00,  1.18s/it]
Train loss: 11.04238451700491, Disc Loss: 15.942183505538987, Adv Loss: 0.5700676767278541, FM Loss: 0.1480544634357025, Recon Loss: 3.755608945792921, Time Loss: 0.10855199437878921
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.623465087182274, Dist Loss: 0.0, Recon Loss: 3.7986663204238607, Time Loss: 0.13066226661560687
EarlyStopping counter: 1 out of 10
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:07<00:00,  1.18s/it]
Train loss: 10.926837301071421, Disc Loss: 15.944909725181082, Adv Loss: 0.4828015438383774, FM Loss: 0.1462695166868609, Recon Loss: 3.7593207323759428, Time Loss: 0.10820292239722212
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:48<00:00,  1.25it/s]
Valid loss: 7.578359157913182, Dist Loss: 0.0, Recon Loss: 3.7762000536390627, Time Loss: 0.1297952346789319
EarlyStopping counter: 2 out of 10
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:00<00:00,  1.20s/it]
Train loss: 10.888511565476211, Disc Loss: 15.941244807200682, Adv Loss: 0.42229625180166835, FM Loss: 0.14798653679397902, Recon Loss: 3.7532403663111893, Time Loss: 0.1073474952999485
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:51<00:00,  1.24it/s]
Valid loss: 7.476956179032334, Dist Loss: 0.0, Recon Loss: 3.7254337017540227, Time Loss: 0.1304438967746405
Validation loss decreased (7.484338 --> 7.476956).  Saving model ...
tensor([ 0.0309,  0.0373,  0.0367,  ..., -0.0224, -0.0218, -0.0205],
       device='cuda:0') -0.3580499291419983 0.33758455514907837
tensor([ 0.0202,  0.0201,  0.0207,  ..., -0.0525, -0.0542, -0.0466],
       device='cuda:0') -1.2944859266281128 1.232367992401123
tensor([ 0.0131,  0.0135,  0.0148,  ..., -0.0218, -0.0219, -0.0188],
       device='cuda:0') -0.3653762638568878 0.39508500695228577
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:15<00:00,  1.21s/it]
Train loss: 10.908664611536846, Disc Loss: 15.941131630805284, Adv Loss: 0.3802829607527562, FM Loss: 0.15265282662208404, Recon Loss: 3.7376632317614953, Time Loss: 0.10757556946215652
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:51<00:00,  1.25it/s]
Valid loss: 7.5457922587809, Dist Loss: 0.0, Recon Loss: 3.7598860158221683, Time Loss: 0.1301010956280124
EarlyStopping counter: 1 out of 10
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:01<00:00,  1.18s/it]
Train loss: 11.067116736959385, Disc Loss: 15.940785444184066, Adv Loss: 0.4654493035282741, FM Loss: 0.15424949278666916, Recon Loss: 3.7583476343102085, Time Loss: 0.10745245836671992
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:47<00:00,  1.26it/s]
Valid loss: 7.812145345255707, Dist Loss: 0.0, Recon Loss: 3.8930239250956444, Time Loss: 0.1304874645904646
EarlyStopping counter: 2 out of 10
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:26<00:00,  1.19s/it]
Train loss: 11.017690537887072, Disc Loss: 15.940715541116319, Adv Loss: 0.43719284779272743, FM Loss: 0.1553274771483543, Recon Loss: 3.7369822907254804, Time Loss: 0.10749904530120495
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:43<00:00,  1.27it/s]
Valid loss: 7.539857185272789, Dist Loss: 0.0, Recon Loss: 3.756863466113349, Time Loss: 0.1306512689176674
EarlyStopping counter: 3 out of 10
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:53<00:00,  1.20s/it]
Train loss: 11.085104781412094, Disc Loss: 15.939314151043886, Adv Loss: 0.43225607366118984, FM Loss: 0.15799346780797294, Recon Loss: 3.746496434002467, Time Loss: 0.10666631186927793
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.629615850302389, Dist Loss: 0.0, Recon Loss: 3.801927154677487, Time Loss: 0.12880769420853058
EarlyStopping counter: 4 out of 10
Epoch 12
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:24<00:00,  1.21s/it]
Train loss: 11.11730421559578, Disc Loss: 15.942296681934385, Adv Loss: 0.4727420424927434, FM Loss: 0.15821415137675757, Recon Loss: 3.74014144904775, Time Loss: 0.10639220182190665
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:46<00:00,  1.26it/s]
Valid loss: 7.611160500898475, Dist Loss: 0.0, Recon Loss: 3.7924967279222996, Time Loss: 0.1308352045549851
EarlyStopping counter: 5 out of 10
Epoch 13
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:05<00:00,  1.18s/it]
Train loss: 11.125490136181083, Disc Loss: 15.943455075628462, Adv Loss: 0.43062052911629206, FM Loss: 0.16006127752849383, Recon Loss: 3.7468203630760266, Time Loss: 0.10643792237640443
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:28<00:00,  1.31it/s]
Valid loss: 7.498900290851496, Dist Loss: 0.0, Recon Loss: 3.736483946366448, Time Loss: 0.1296620207887898
EarlyStopping counter: 6 out of 10
Epoch 14
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:34<00:00,  1.19s/it]
Train loss: 11.118875238607933, Disc Loss: 15.94364481252663, Adv Loss: 0.3715215942226779, FM Loss: 0.1620768159818385, Recon Loss: 3.752898052493511, Time Loss: 0.10595450518096464
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.519545364217417, Dist Loss: 0.0, Recon Loss: 3.7469997840601907, Time Loss: 0.12772895299609008
EarlyStopping counter: 7 out of 10
Epoch 15
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:39<00:00,  1.19s/it]
Train loss: 11.032395120270465, Disc Loss: 15.94383787814231, Adv Loss: 0.3330444283926289, FM Loss: 0.16152656337378835, Recon Loss: 3.734413093132926, Time Loss: 0.10665341716975571
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.525769822642181, Dist Loss: 0.0, Recon Loss: 3.749941927813996, Time Loss: 0.129429826141673
EarlyStopping counter: 8 out of 10
Epoch 16
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:55<00:00,  1.20s/it]
Train loss: 10.87956080459055, Disc Loss: 15.94599155837239, Adv Loss: 0.20681522143461067, FM Loss: 0.16036559512476034, Recon Loss: 3.732715905449164, Time Loss: 0.10650632472357244
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:40<00:00,  1.27it/s]
Valid loss: 7.43900472423287, Dist Loss: 0.0, Recon Loss: 3.7065773383925276, Time Loss: 0.12925024840225555
Validation loss decreased (7.476956 --> 7.439005).  Saving model ...
tensor([-0.0174, -0.0152, -0.0185,  ..., -0.0269, -0.0237, -0.0231],
       device='cuda:0') -0.37204158306121826 0.35768839716911316
tensor([-0.0022, -0.0062, -0.0098,  ..., -0.0561, -0.0563, -0.0508],
       device='cuda:0') -1.366451621055603 1.492337942123413
tensor([-0.0034, -0.0068, -0.0095,  ..., -0.0224, -0.0219, -0.0201],
       device='cuda:0') -0.46445679664611816 0.43051689863204956
Epoch 17
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:13<00:00,  1.18s/it]
Train loss: 10.945533650044334, Disc Loss: 15.939374067959097, Adv Loss: 0.1773136823188512, FM Loss: 0.16501713977451268, Recon Loss: 3.7339315637914385, Time Loss: 0.10629083522213333
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.7877421013541275, Dist Loss: 0.0, Recon Loss: 3.881017151236331, Time Loss: 0.12853892502617695
EarlyStopping counter: 1 out of 10
Epoch 18
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:09<00:00,  1.21s/it]
Train loss: 10.981330566828841, Disc Loss: 15.943301954622923, Adv Loss: 0.2692956912248349, FM Loss: 0.16350730632689336, Recon Loss: 3.72094515571708, Time Loss: 0.10636712939124895
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:45<00:00,  1.26it/s]
Valid loss: 7.461121000260673, Dist Loss: 0.0, Recon Loss: 3.7177059975352766, Time Loss: 0.12854495008033423
EarlyStopping counter: 2 out of 10
Epoch 19
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:25<00:00,  1.21s/it]
Train loss: 11.057117890031682, Disc Loss: 15.943964369407755, Adv Loss: 0.34670722743628835, FM Loss: 0.16381682504427195, Recon Loss: 3.7170367185034343, Time Loss: 0.10581926820370356
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:53<00:00,  1.24it/s]
Valid loss: 7.321920431452269, Dist Loss: 0.0, Recon Loss: 3.648272388838422, Time Loss: 0.1268782734623404
Validation loss decreased (7.439005 --> 7.321920).  Saving model ...
tensor([ 0.0085,  0.0162,  0.0142,  ..., -0.0284, -0.0269, -0.0248],
       device='cuda:0') -0.38953152298927307 0.3611443340778351
tensor([ 0.0109,  0.0113,  0.0104,  ..., -0.0499, -0.0464, -0.0370],
       device='cuda:0') -1.2512294054031372 1.3687409162521362
tensor([ 0.0087,  0.0100,  0.0105,  ..., -0.0217, -0.0185, -0.0127],
       device='cuda:0') -0.3840649127960205 0.4515363574028015
Epoch 20
  1%|█                                                                                                                                                                     | 15/2347 [00:23<1:16:08,  1.96s/it]
  1%|█                                                                                                                                                                     | 15/2347 [00:24<1:02:37,  1.61s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 517, in <module>
    # checkpoint = None
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 389, in train
    beginning = peak_norm(apply_augmentations_adv(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 162, in pitch_shift
    output = resampler(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1494, in _call_impl
    def _call_impl(self, *args, **kwargs):
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.0002
Resuming from model with val loss: 7.321920431452269
Resuming from disc checkpoint
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:21<00:00,  1.21s/it]
Train loss: 11.115559087898765, Disc Loss: 15.943361871538134, Adv Loss: 0.4057371694583511, FM Loss: 0.16526026618089582, Recon Loss: 3.7023042418573784, Time Loss: 0.10569951474399937
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.613557451628339, Dist Loss: 0.0, Recon Loss: 3.7939508659876187, Time Loss: 0.1282785997315099
EarlyStopping counter: 1 out of 10
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:28<00:00,  1.19s/it]
Train loss: 11.062163660157525, Disc Loss: 15.94162760971453, Adv Loss: 0.37304388435536057, FM Loss: 0.1648943933162681, Recon Loss: 3.695613511938413, Time Loss: 0.10576107523760797
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.813515194433105, Dist Loss: 0.0, Recon Loss: 3.894015689927837, Time Loss: 0.1274190528423
EarlyStopping counter: 2 out of 10
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:29<00:00,  1.19s/it]
Train loss: 10.899632582321134, Disc Loss: 15.942493076267576, Adv Loss: 0.1693747170590115, FM Loss: 0.16643046641989775, Recon Loss: 3.7008234319861613, Time Loss: 0.10465800347267744
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:51<00:00,  1.24it/s]
Valid loss: 7.451750815422409, Dist Loss: 0.0, Recon Loss: 3.7131563516451105, Time Loss: 0.12719052742525708
EarlyStopping counter: 3 out of 10
Epoch 4
  3%|█████▊                                                                                                                                                                  | 82/2347 [01:47<32:17,  1.17it/s]
  3%|█████▊                                                                                                                                                                  | 82/2347 [01:47<49:31,  1.31s/it]
Traceback (most recent call last):
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 520, in <module>
    train(trainer, train_dl, val_dl, lr=training_params["learning_rate"],
  File "/home/r/Documents/Projects/orpheus/orpheus/train.py", line 389, in train
    beginning = peak_norm(apply_augmentations_adv(real_imgs, sample_rate=bitrate).cuda())
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/composition.py", line 210, in forward
    inputs = self.transforms[i](**inputs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/core/transforms_interface.py", line 341, in forward
    perturbed: ObjectDict = self.apply_transform(
  File "/home/r/.local/lib/python3.10/site-packages/torch_audiomentations/augmentations/pitch_shift.py", line 121, in apply_transform
    samples[i, ...] = pitch_shift(
  File "/home/r/.local/lib/python3.10/site-packages/torch_pitch_shift/main.py", line 160, in pitch_shift
    output = stretcher(output)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/transforms/_transforms.py", line 1110, in forward
    return F.phase_vocoder(complex_specgrams, rate, self.phase_advance)
  File "/usr/local/lib/python3.10/dist-packages/torchaudio/functional/functional.py", line 789, in phase_vocoder
    phase = torch.cat([phase_0, phase[..., :-1]], dim=-1)
KeyboardInterrupt

r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 7.321920431452269
Resuming from disc checkpoint
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:56<00:00,  1.15s/it]
Train loss: 11.104362027818821, Disc Loss: 15.944020957605455, Adv Loss: 0.39000185367956436, FM Loss: 0.16550604515904613, Recon Loss: 3.702120525358482, Time Loss: 0.10573690404467091
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:22<00:00,  1.33it/s]
Valid loss: 7.359350600884355, Dist Loss: 0.0, Recon Loss: 3.666871576536656, Time Loss: 0.1280372405719818
EarlyStopping counter: 1 out of 10
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:06<00:00,  1.15s/it]
Train loss: 11.082882126189315, Disc Loss: 15.941843976352791, Adv Loss: 0.384314427743529, FM Loss: 0.16624083354415212, Recon Loss: 3.6868728084873026, Time Loss: 0.10598826642982696
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:24<00:00,  1.32it/s]
Valid loss: 7.5608391924245595, Dist Loss: 0.0, Recon Loss: 3.767451993448365, Time Loss: 0.1296759981541455
EarlyStopping counter: 2 out of 10
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [44:57<00:00,  1.15s/it]
Train loss: 10.913806224102968, Disc Loss: 15.944050916063059, Adv Loss: 0.19626264080475075, FM Loss: 0.16586640483529505, Recon Loss: 3.700116371773231, Time Loss: 0.1051816058761397
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:22<00:00,  1.33it/s]
Valid loss: 7.5739699287349564, Dist Loss: 0.0, Recon Loss: 3.7743206247560415, Time Loss: 0.12664343319909435
EarlyStopping counter: 3 out of 10
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:49<00:00,  1.17s/it]
Train loss: 10.87560651898638, Disc Loss: 15.940898620579462, Adv Loss: 0.11210423629234129, FM Loss: 0.16806595895358437, Recon Loss: 3.701093738821653, Time Loss: 0.10518268613255069
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:21<00:00,  1.33it/s]
Valid loss: 7.416466061463754, Dist Loss: 0.0, Recon Loss: 3.695379015940418, Time Loss: 0.12854022916971217
EarlyStopping counter: 4 out of 10
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:33<00:00,  1.16s/it]
Train loss: 10.789870380390234, Disc Loss: 15.942409858329782, Adv Loss: 0.08606045450308905, FM Loss: 0.16608378569217352, Recon Loss: 3.691069653555338, Time Loss: 0.10479740631494006
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:22<00:00,  1.33it/s]
Valid loss: 7.707341994296956, Dist Loss: 0.0, Recon Loss: 3.840953392714414, Time Loss: 0.12717601979941484
EarlyStopping counter: 5 out of 10
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:16<00:00,  1.16s/it]
Train loss: 10.726260790684703, Disc Loss: 15.942083644013634, Adv Loss: 0.030808580851219642, FM Loss: 0.16758514131238017, Recon Loss: 3.6718795316799375, Time Loss: 0.10506259659198075
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:22<00:00,  1.33it/s]
Valid loss: 7.424282376973348, Dist Loss: 0.0, Recon Loss: 3.6996418881456936, Time Loss: 0.12499303341521112
EarlyStopping counter: 6 out of 10
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:25<00:00,  1.16s/it]
Train loss: 10.657884244670957, Disc Loss: 15.94195715274819, Adv Loss: -0.03396711768015019, FM Loss: 0.1673255273520718, Recon Loss: 3.672670512896271, Time Loss: 0.10484507052179444
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:30<00:00,  1.30it/s]
Valid loss: 7.369544267248254, Dist Loss: 0.0, Recon Loss: 3.672112821111078, Time Loss: 0.12659309117133005
EarlyStopping counter: 7 out of 10
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:26<00:00,  1.16s/it]
Train loss: 10.801525326856005, Disc Loss: 15.934410950149127, Adv Loss: 0.006448245932307201, FM Loss: 0.1723245068921096, Recon Loss: 3.674296442173266, Time Loss: 0.1051190672358986
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:24<00:00,  1.32it/s]
Valid loss: 7.363535389583399, Dist Loss: 0.0, Recon Loss: 3.669035666642847, Time Loss: 0.12732026664765467
EarlyStopping counter: 8 out of 10
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:29<00:00,  1.16s/it]
Train loss: 10.856699737935662, Disc Loss: 15.938911376224969, Adv Loss: 0.1173087121275165, FM Loss: 0.1700522671062793, Recon Loss: 3.6691843893459923, Time Loss: 0.10454032516315688
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:23<00:00,  1.32it/s]
Valid loss: 7.316590145052596, Dist Loss: 0.0, Recon Loss: 3.6458015677469957, Time Loss: 0.12493505948929202
Validation loss decreased (7.321920 --> 7.316590).  Saving model ...
tensor([-0.0094, -0.0021, -0.0046,  ..., -0.0302, -0.0278, -0.0263],
       device='cuda:0') -0.36589759588241577 0.3694232404232025
tensor([ 0.0062,  0.0047,  0.0041,  ..., -0.0660, -0.0649, -0.0590],
       device='cuda:0') -1.1921864748001099 1.209458827972412
tensor([-0.0001, -0.0009, -0.0012,  ..., -0.0264, -0.0210, -0.0159],
       device='cuda:0') -0.4789418876171112 0.46949005126953125
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:27<00:00,  1.16s/it]
Train loss: 10.809626571970592, Disc Loss: 15.937799584576055, Adv Loss: 0.0838121398743742, FM Loss: 0.17082848242104282, Recon Loss: 3.654626445664616, Time Loss: 0.10449377879894028
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:22<00:00,  1.33it/s]
Valid loss: 7.497217262826949, Dist Loss: 0.0, Recon Loss: 3.7358818033890993, Time Loss: 0.12726827432263446
EarlyStopping counter: 1 out of 10
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:20<00:00,  1.16s/it]
Train loss: 10.847634613742512, Disc Loss: 15.936348263740946, Adv Loss: 0.1149202272848317, FM Loss: 0.17066813185715807, Recon Loss: 3.659682536054074, Time Loss: 0.1048777450303042
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:24<00:00,  1.32it/s]
Valid loss: 7.227829113526482, Dist Loss: 0.0, Recon Loss: 3.6013787288275854, Time Loss: 0.12535824199894116
Validation loss decreased (7.316590 --> 7.227829).  Saving model ...
tensor([ 0.0157,  0.0231,  0.0189,  ..., -0.0315, -0.0296, -0.0285],
       device='cuda:0') -0.38249504566192627 0.37550660967826843
tensor([ 0.0089,  0.0080,  0.0037,  ..., -0.0602, -0.0600, -0.0526],
       device='cuda:0') -1.2572602033615112 1.4536077976226807
tensor([ 0.0062,  0.0067,  0.0037,  ..., -0.0124, -0.0079, -0.0034],
       device='cuda:0') -0.4991488754749298 0.4283393621444702
Epoch 12
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:04<00:00,  1.18s/it]
Train loss: 10.76916961076669, Disc Loss: 15.934890285470814, Adv Loss: 0.010145150807546868, FM Loss: 0.17212145512389487, Recon Loss: 3.6582989799351604, Time Loss: 0.10451196946606872
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:27<00:00,  1.31it/s]
Valid loss: 7.436295826146712, Dist Loss: 0.0, Recon Loss: 3.7054857310079026, Time Loss: 0.12662182046731957
EarlyStopping counter: 1 out of 10
Epoch 13
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:32<00:00,  1.16s/it]
Train loss: 10.653757369614786, Disc Loss: 15.935815668939071, Adv Loss: -0.10736008568118875, FM Loss: 0.17378126289878035, Recon Loss: 3.6427401732423226, Time Loss: 0.10485560309997405
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:25<00:00,  1.32it/s]
Valid loss: 7.405924537112806, Dist Loss: 0.0, Recon Loss: 3.6903740961669453, Time Loss: 0.12588172927308428
EarlyStopping counter: 2 out of 10
Epoch 14
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:06<00:00,  1.18s/it]
Train loss: 10.530529109985716, Disc Loss: 15.937040636983383, Adv Loss: -0.2593509396137356, FM Loss: 0.17366678622310397, Recon Loss: 3.6582727834525186, Time Loss: 0.10394073492150181
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:25<00:00,  1.32it/s]
Valid loss: 7.423692825096429, Dist Loss: 0.0, Recon Loss: 3.6992695270648808, Time Loss: 0.12576880916204222
EarlyStopping counter: 3 out of 10
Epoch 15
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:20<00:00,  1.16s/it]
Train loss: 10.436261607374492, Disc Loss: 15.934700548572646, Adv Loss: -0.3719444453690882, FM Loss: 0.17477532717132244, Recon Loss: 3.6563573989860036, Time Loss: 0.10439727419188137
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:24<00:00,  1.32it/s]
Valid loss: 7.566691770667315, Dist Loss: 0.0, Recon Loss: 3.770780986171768, Time Loss: 0.12564895270008347
EarlyStopping counter: 4 out of 10
Epoch 16
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:54<00:00,  1.17s/it]
Train loss: 10.444226129643196, Disc Loss: 15.938458670643374, Adv Loss: -0.34401801377090435, FM Loss: 0.17480721004373934, Recon Loss: 3.646042745977856, Time Loss: 0.10382976467730291
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:26<00:00,  1.32it/s]
Valid loss: 7.497621887993366, Dist Loss: 0.0, Recon Loss: 3.7362836308942335, Time Loss: 0.1252730617734399
EarlyStopping counter: 5 out of 10
Epoch 17
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:45<00:00,  1.17s/it]
Train loss: 10.46819875389655, Disc Loss: 15.937413453344695, Adv Loss: -0.34982563761583935, FM Loss: 0.17583037458890338, Recon Loss: 3.6507124522923915, Time Loss: 0.10422491727608744
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:23<00:00,  1.32it/s]
Valid loss: 7.454565899538628, Dist Loss: 0.0, Recon Loss: 3.714734548604468, Time Loss: 0.12548395438878154
EarlyStopping counter: 6 out of 10
Epoch 18
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:25<00:00,  1.16s/it]
Train loss: 10.444100358814293, Disc Loss: 15.937736338943331, Adv Loss: -0.3782924136863549, FM Loss: 0.17548455204616265, Recon Loss: 3.6563580917915894, Time Loss: 0.10393969535757798
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:23<00:00,  1.32it/s]
Valid loss: 7.635145709705515, Dist Loss: 0.0, Recon Loss: 3.8050550654962074, Time Loss: 0.12517787335881586
EarlyStopping counter: 7 out of 10
Epoch 19
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:23<00:00,  1.16s/it]
Train loss: 10.430668806897664, Disc Loss: 15.937922747123988, Adv Loss: -0.42402358313139116, FM Loss: 0.17693938363802195, Recon Loss: 3.65794934167931, Time Loss: 0.10439032788575331
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:24<00:00,  1.32it/s]
Valid loss: 7.328596295449356, Dist Loss: 0.0, Recon Loss: 3.6517756724479455, Time Loss: 0.12522474595137714
EarlyStopping counter: 8 out of 10
Epoch 20
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:09<00:00,  1.15s/it]
Train loss: 10.360734726247962, Disc Loss: 15.93897129314018, Adv Loss: -0.48262123397222517, FM Loss: 0.17734782767895185, Recon Loss: 3.64820095108172, Time Loss: 0.10438744584277025
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:32<00:00,  1.30it/s]
Valid loss: 7.478554826375776, Dist Loss: 0.0, Recon Loss: 3.726731396208833, Time Loss: 0.12546016463733817
EarlyStopping counter: 9 out of 10
Epoch 21
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:04<00:00,  1.18s/it]
Train loss: 10.257611183293282, Disc Loss: 15.93728696207925, Adv Loss: -0.5583699977697593, FM Loss: 0.17689202743029667, Recon Loss: 3.639067662031436, Time Loss: 0.10376057168607718
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:20<00:00,  1.33it/s]
Valid loss: 7.379374364368757, Dist Loss: 0.0, Recon Loss: 3.6772601738495965, Time Loss: 0.12427010868867983
EarlyStopping counter: 10 out of 10
Early stopping
r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:35<00:00,  1.19s/it]
Train loss: 9.763800206974715, Disc Loss: 15.991618289305496, Adv Loss: 0.1424460360279579, FM Loss: 0.0945366435625932, Recon Loss: 3.8653076871385155, Time Loss: 0.21943285755581382
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:54<00:00,  1.24it/s]
Valid loss: 7.836487107220053, Dist Loss: 0.0, Recon Loss: 3.891419106894498, Time Loss: 0.2682444198307735
Validation loss decreased (inf --> 7.836487).  Saving model ...
tensor([0.0339, 0.0461, 0.0447,  ..., 0.0177, 0.0191, 0.0195], device='cuda:0') -0.36770719289779663 0.3418206572532654
tensor([-0.0006,  0.0018,  0.0035,  ..., -0.0667, -0.0667, -0.0637],
       device='cuda:0') -1.2406065464019775 1.3899177312850952
tensor([ 0.0015,  0.0040,  0.0053,  ..., -0.0322, -0.0288, -0.0253],
       device='cuda:0') -0.45242443680763245 0.40307700634002686
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:04<00:00,  1.20s/it]
Train loss: 9.720679205328443, Disc Loss: 15.98739747550064, Adv Loss: 0.30752600615817943, FM Loss: 0.08692835258025539, Recon Loss: 3.837301684787134, Time Loss: 0.2211315988015001
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:49<00:00,  1.25it/s]
Valid loss: 7.845617891373383, Dist Loss: 0.0, Recon Loss: 3.895810169499412, Time Loss: 0.26998769348484086
EarlyStopping counter: 1 out of 10
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:02<00:00,  1.20s/it]
Train loss: 10.034943444098012, Disc Loss: 15.985822992117598, Adv Loss: 0.5199460759790694, FM Loss: 0.0942054751785857, Recon Loss: 3.8154413583281706, Time Loss: 0.22060441120690774
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:55<00:00,  1.23it/s]
Valid loss: 7.710990534527339, Dist Loss: 0.0, Recon Loss: 3.8284012459002725, Time Loss: 0.27094027356861805
Validation loss decreased (7.836487 --> 7.710991).  Saving model ...
tensor([0.0383, 0.0480, 0.0464,  ..., 0.0276, 0.0284, 0.0284], device='cuda:0') -0.35207509994506836 0.3517858386039734
tensor([-0.0017, -0.0016, -0.0002,  ..., -0.0618, -0.0679, -0.0665],
       device='cuda:0') -1.4026234149932861 1.389237642288208
tensor([ 0.0023,  0.0025,  0.0030,  ..., -0.0178, -0.0162, -0.0136],
       device='cuda:0') -0.4257119596004486 0.3938649594783783
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:42<00:00,  1.19s/it]
Train loss: 10.16435020895374, Disc Loss: 15.984691228163614, Adv Loss: 0.3814980450416048, FM Loss: 0.10866491694017628, Recon Loss: 3.804781853009855, Time Loss: 0.2223318576825442
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:57<00:00,  1.23it/s]
Valid loss: 7.637710138317673, Dist Loss: 0.0, Recon Loss: 3.791957703319075, Time Loss: 0.26897363266963165
Validation loss decreased (7.710991 --> 7.637710).  Saving model ...
tensor([0.0299, 0.0386, 0.0392,  ..., 0.0238, 0.0250, 0.0255], device='cuda:0') -0.3222337067127228 0.38367369771003723
tensor([ 0.0041,  0.0038,  0.0066,  ..., -0.0399, -0.0403, -0.0399],
       device='cuda:0') -1.1968539953231812 1.499969482421875
tensor([ 0.0040,  0.0043,  0.0072,  ..., -0.0115, -0.0092, -0.0068],
       device='cuda:0') -0.4317071735858917 0.40638938546180725
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:37<00:00,  1.22s/it]
Train loss: 10.920113956466045, Disc Loss: 15.972062073924159, Adv Loss: 0.2141407615944432, FM Loss: 0.15474544569030943, Recon Loss: 3.8055288643343275, Time Loss: 0.21952097742644888
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:57<00:00,  1.23it/s]
Valid loss: 7.650247662396406, Dist Loss: 0.0, Recon Loss: 3.798549847870913, Time Loss: 0.26573985789662935
EarlyStopping counter: 1 out of 10
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:00<00:00,  1.20s/it]
Train loss: 11.698739069291364, Disc Loss: 15.971000213037922, Adv Loss: 0.5663351961842079, FM Loss: 0.17481534979827973, Recon Loss: 3.818039181286292, Time Loss: 0.2184689736456428
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:53<00:00,  1.24it/s]
Valid loss: 7.8035427829475985, Dist Loss: 0.0, Recon Loss: 3.8757626945359136, Time Loss: 0.26008693889748097
EarlyStopping counter: 2 out of 10
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:25<00:00,  1.19s/it]
Train loss: 10.89865740990202, Disc Loss: 15.963054564337453, Adv Loss: 0.5595905156048196, FM Loss: 0.1314027881337878, Recon Loss: 3.8554943346398205, Time Loss: 0.1273044959190022
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:54<00:00,  1.24it/s]
Valid loss: 7.781037675867292, Dist Loss: 0.0, Recon Loss: 3.8772310849145892, Time Loss: 0.13287749787510153
EarlyStopping counter: 3 out of 10
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:20<00:00,  1.21s/it]
Train loss: 10.756654797486158, Disc Loss: 15.951663693012357, Adv Loss: 0.661725980858626, FM Loss: 0.12597593836546656, Recon Loss: 3.787697948797947, Time Loss: 0.1084027351088533
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:52<00:00,  1.24it/s]
Valid loss: 7.504774821474768, Dist Loss: 0.0, Recon Loss: 3.739067749026687, Time Loss: 0.13319659950862142
Validation loss decreased (7.637710 --> 7.504775).  Saving model ...
tensor([-0.0279, -0.0218, -0.0282,  ..., -0.0286, -0.0285, -0.0282],
       device='cuda:0') -0.39191126823425293 0.3504997491836548
tensor([-0.0223, -0.0242, -0.0260,  ..., -0.0354, -0.0373, -0.0364],
       device='cuda:0') -1.5566699504852295 1.218209147453308
tensor([-0.0211, -0.0228, -0.0254,  ..., -0.0178, -0.0196, -0.0198],
       device='cuda:0') -0.37928518652915955 0.4241386651992798
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:12<00:00,  1.18s/it]
Train loss: 10.790665361593772, Disc Loss: 15.94705674797614, Adv Loss: 0.5412188718102564, FM Loss: 0.13407775072732478, Recon Loss: 3.7839514033866526, Time Loss: 0.10865883384587209
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:55<00:00,  1.24it/s]
Valid loss: 7.765139508287992, Dist Loss: 0.0, Recon Loss: 3.869563719686089, Time Loss: 0.13006036155865078
EarlyStopping counter: 1 out of 10
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:05<00:00,  1.20s/it]
Train loss: 10.74035926245099, Disc Loss: 15.95318491691521, Adv Loss: 0.5030601543723953, FM Loss: 0.13541399675782914, Recon Loss: 3.764501684718707, Time Loss: 0.10811774999944515
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.570900210326941, Dist Loss: 0.0, Recon Loss: 3.772263381103438, Time Loss: 0.13186727613972238
EarlyStopping counter: 2 out of 10
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:16<00:00,  1.21s/it]
Train loss: 10.744097847810542, Disc Loss: 15.95169032275245, Adv Loss: 0.4863712813024273, FM Loss: 0.1373655874271011, Recon Loss: 3.755217448061052, Time Loss: 0.10785419126463841
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:54<00:00,  1.24it/s]
Valid loss: 7.310316064694874, Dist Loss: 0.0, Recon Loss: 3.641926671617888, Time Loss: 0.13231367118072773
Validation loss decreased (7.504775 --> 7.310316).  Saving model ...
tensor([ 0.0010,  0.0100,  0.0043,  ..., -0.0262, -0.0254, -0.0246],
       device='cuda:0') -0.36532461643218994 0.3512282967567444
tensor([ 2.4462e-03,  1.3411e-03,  7.0463e-05,  ..., -3.0343e-02,
        -3.8048e-02, -3.7119e-02], device='cuda:0') -1.2839100360870361 1.2553257942199707
tensor([-0.0009, -0.0009, -0.0021,  ..., -0.0056, -0.0052, -0.0044],
       device='cuda:0') -0.39175939559936523 0.3968711197376251
Epoch 12
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:50<00:00,  1.20s/it]
Train loss: 10.766014746010532, Disc Loss: 15.94890085747763, Adv Loss: 0.4203539061251731, FM Loss: 0.14034572580188806, Recon Loss: 3.769370715974695, Time Loss: 0.10792499157815574
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:54<00:00,  1.24it/s]
Valid loss: 7.563898504897318, Dist Loss: 0.0, Recon Loss: 3.768872085178122, Time Loss: 0.13077165220992631
EarlyStopping counter: 1 out of 10
Epoch 13
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:09<00:00,  1.21s/it]
Train loss: 10.671024542744737, Disc Loss: 15.945924984022156, Adv Loss: 0.35476986235337, FM Loss: 0.14151342950275617, Recon Loss: 3.74299465365546, Time Loss: 0.10803943227073412
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:58<00:00,  1.23it/s]
Valid loss: 7.801423777104237, Dist Loss: 0.0, Recon Loss: 3.8876706786212565, Time Loss: 0.130412083198483
EarlyStopping counter: 2 out of 10
Epoch 14
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:47<00:00,  1.22s/it]
Train loss: 10.71188288746766, Disc Loss: 15.942869221346399, Adv Loss: 0.28675783122403603, FM Loss: 0.14711592113103164, Recon Loss: 3.741387764849864, Time Loss: 0.10799237591792636
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:53<00:00,  1.24it/s]
Valid loss: 7.496602471073807, Dist Loss: 0.0, Recon Loss: 3.7351597285555007, Time Loss: 0.13141505291377664
EarlyStopping counter: 3 out of 10
Epoch 15
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:29<00:00,  1.21s/it]
Train loss: 10.717911777975816, Disc Loss: 15.947825681721346, Adv Loss: 0.2790735648650538, FM Loss: 0.1469135195029559, Recon Loss: 3.7502885884714474, Time Loss: 0.10771413000628295
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:55<00:00,  1.24it/s]
Valid loss: 7.578741284813954, Dist Loss: 0.0, Recon Loss: 3.7763176906657177, Time Loss: 0.13052949894479837
EarlyStopping counter: 4 out of 10
Epoch 16
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:01<00:00,  1.20s/it]
Train loss: 10.749252013770072, Disc Loss: 15.950814870046868, Adv Loss: 0.32638517297680547, FM Loss: 0.1482833387702386, Recon Loss: 3.72859129298226, Time Loss: 0.10722939064388942
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [08:00<00:00,  1.22it/s]
Valid loss: 7.600474391722801, Dist Loss: 0.0, Recon Loss: 3.787391518815413, Time Loss: 0.12845678040773642
EarlyStopping counter: 5 out of 10
Epoch 17
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:21<00:00,  1.21s/it]
Train loss: 10.683633003429906, Disc Loss: 15.951853429910525, Adv Loss: 0.19541873289871378, FM Loss: 0.15132159967345282, Recon Loss: 3.730889838047621, Time Loss: 0.10741912020258462
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [08:00<00:00,  1.22it/s]
Valid loss: 7.589465253397797, Dist Loss: 0.0, Recon Loss: 3.781560958751828, Time Loss: 0.13171661839054127
EarlyStopping counter: 6 out of 10
Epoch 18
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:10<00:00,  1.21s/it]
Train loss: 10.651077999071106, Disc Loss: 15.942692799318278, Adv Loss: 0.09235492928971825, FM Loss: 0.15425276949296976, Recon Loss: 3.7368313450482127, Time Loss: 0.1069115798207715
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:53<00:00,  1.24it/s]
Valid loss: 7.536721388769719, Dist Loss: 0.0, Recon Loss: 3.755552463271549, Time Loss: 0.1280822810229847
EarlyStopping counter: 7 out of 10
Epoch 19
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:50<00:00,  1.20s/it]
Train loss: 10.698401169112554, Disc Loss: 15.9404259426928, Adv Loss: 0.06666947873948126, FM Loss: 0.1566239346023514, Recon Loss: 3.7496295666054658, Time Loss: 0.10649587650647253
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:54<00:00,  1.24it/s]
Valid loss: 7.759473978559244, Dist Loss: 0.0, Recon Loss: 3.866794230381512, Time Loss: 0.12942757069734537
EarlyStopping counter: 8 out of 10
Epoch 20
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:11<00:00,  1.21s/it]
Train loss: 10.60114251150189, Disc Loss: 15.942749387515978, Adv Loss: 0.007134325818198764, FM Loss: 0.15832925218696742, Recon Loss: 3.713709801270396, Time Loss: 0.1069444758086622
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:54<00:00,  1.24it/s]
Valid loss: 7.749184877340391, Dist Loss: 0.0, Recon Loss: 3.8617501193863775, Time Loss: 0.1284231746750146
EarlyStopping counter: 9 out of 10
Epoch 21
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:34<00:00,  1.22s/it]
Train loss: 10.605840849988146, Disc Loss: 15.939260891563698, Adv Loss: -0.06331699210428206, FM Loss: 0.16186874513175065, Recon Loss: 3.715893914763553, Time Loss: 0.1068963482134714
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:59<00:00,  1.22it/s]
Valid loss: 7.501590684893997, Dist Loss: 0.0, Recon Loss: 3.737854735814733, Time Loss: 0.12940605623200155
EarlyStopping counter: 10 out of 10
Early stopping
r@Azumith:~/Documents/Projects/orpheus/orpheus$ python3 train.py
31823877
Learning rate: 0.00015
Resuming from model with val loss: 9.812762280647329
Parameter containing:
tensor([-1.0431,  4.0576, -1.0643], requires_grad=True)
tensor(0.8405) Parameter containing:
tensor(48.9445, requires_grad=True)
tensor(0.6425) Parameter containing:
tensor(92.7547, requires_grad=True)
tensor(-1.0062) Parameter containing:
tensor(92.7992, requires_grad=True)
Parameter containing:
tensor([0.6123, 0.9671, 0.9559], requires_grad=True)
Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:10<00:00,  1.21s/it]
Train loss: nan, Disc Loss: 15.992510385598637, Adv Loss: 0.20713115378446054, FM Loss: nan, Recon Loss: 3.8690814126741646, Time Loss: 0.2199298720132253
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.884816800918449, Dist Loss: 0.0, Recon Loss: 3.915860974199727, Time Loss: 0.2654742584317872
Validation loss decreased (inf --> 7.884817).  Saving model ...
tensor([0.0175, 0.0302, 0.0288,  ..., 0.0249, 0.0256, 0.0256], device='cuda:0') -0.3223695755004883 0.32370367646217346
tensor([-0.0013,  0.0002,  0.0015,  ..., -0.0493, -0.0533, -0.0550],
       device='cuda:0') -1.2721508741378784 1.3434531688690186
tensor([ 0.0012,  0.0028,  0.0037,  ..., -0.0318, -0.0293, -0.0259],
       device='cuda:0') -0.34390565752983093 0.405283659696579
Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:00<00:00,  1.20s/it]
Train loss: 9.49392233171207, Disc Loss: 15.986901496591393, Adv Loss: 0.31369851384205566, FM Loss: 0.07833979329912522, Recon Loss: 3.8067141542243714, Time Loss: 0.22100133155514243
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:46<00:00,  1.26it/s]
Valid loss: 7.643612765778472, Dist Loss: 0.0, Recon Loss: 3.7948951644020146, Time Loss: 0.26911215494296414
Validation loss decreased (7.884817 --> 7.643613).  Saving model ...
tensor([0.0016, 0.0091, 0.0084,  ..., 0.0243, 0.0246, 0.0237], device='cuda:0') -0.354677677154541 0.3348967134952545
tensor([-0.0020, -0.0015,  0.0002,  ..., -0.0494, -0.0530, -0.0536],
       device='cuda:0') -1.2653007507324219 1.3485145568847656
tensor([-0.0002,  0.0005,  0.0018,  ..., -0.0239, -0.0219, -0.0194],
       device='cuda:0') -0.40250393748283386 0.3974972367286682
Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:23<00:00,  1.19s/it]
Train loss: nan, Disc Loss: 15.985609954196846, Adv Loss: 0.48823609776734594, FM Loss: nan, Recon Loss: 3.815459378485889, Time Loss: 0.22134314638391472
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:46<00:00,  1.26it/s]
Valid loss: 7.500522877532335, Dist Loss: 0.0, Recon Loss: 3.723756262959573, Time Loss: 0.26505178369238996
Validation loss decreased (7.643613 --> 7.500523).  Saving model ...
tensor([0.0151, 0.0268, 0.0227,  ..., 0.0233, 0.0245, 0.0253], device='cuda:0') -0.34778401255607605 0.3755005896091461
tensor([ 0.0086,  0.0110,  0.0112,  ..., -0.0615, -0.0674, -0.0678],
       device='cuda:0') -1.230881929397583 1.3066151142120361
tensor([ 0.0081,  0.0106,  0.0104,  ..., -0.0270, -0.0249, -0.0206],
       device='cuda:0') -0.4038953185081482 0.39521723985671997
Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:59<00:00,  1.20s/it]
Train loss: 10.100342498620012, Disc Loss: 15.985520078824031, Adv Loss: 0.7423711125780584, FM Loss: 0.08597865387079916, Recon Loss: 3.81920386244502, Time Loss: 0.22113948677593867
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:51<00:00,  1.24it/s]
Valid loss: 7.6826169145574355, Dist Loss: 0.0, Recon Loss: 3.814514854697596, Time Loss: 0.26793601987106025
EarlyStopping counter: 1 out of 10
Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:02<00:00,  1.20s/it]
Train loss: 10.2706663654264, Disc Loss: 15.985969455688112, Adv Loss: 0.7091216845973584, FM Loss: 0.09791516180895825, Recon Loss: 3.801623638914553, Time Loss: 0.22195487261504177
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:48<00:00,  1.25it/s]
Valid loss: 7.547635805464685, Dist Loss: 0.0, Recon Loss: 3.7466938755581287, Time Loss: 0.27124028368591246
EarlyStopping counter: 2 out of 10
Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:41<00:00,  1.22s/it]
Train loss: 10.523168499235098, Disc Loss: 15.983752529825308, Adv Loss: 0.6484761963410737, FM Loss: 0.1145728184001518, Recon Loss: 3.791610323321225, Time Loss: 0.2203173107437037
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:55<00:00,  1.23it/s]
Valid loss: 7.552634942673743, Dist Loss: 0.0, Recon Loss: 3.749523352926797, Time Loss: 0.2679412021814152
EarlyStopping counter: 3 out of 10
Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:24<00:00,  1.21s/it]
Train loss: 11.06830772055328, Disc Loss: 15.978320062846187, Adv Loss: 0.6728995688478643, FM Loss: 0.1383428000672401, Recon Loss: 3.8142780506920704, Time Loss: 0.21952306013514652
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:50<00:00,  1.25it/s]
Valid loss: 7.560717048190115, Dist Loss: 0.0, Recon Loss: 3.7534054016132776, Time Loss: 0.269531144333759
EarlyStopping counter: 4 out of 10
Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:08<00:00,  1.21s/it]
Train loss: 12.050355537424302, Disc Loss: 15.974671788453344, Adv Loss: 0.8989025322386291, FM Loss: 0.17277549610373616, Recon Loss: 3.847968573970494, Time Loss: 0.2135764636546945
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:52<00:00,  1.24it/s]
Valid loss: 7.920245274571381, Dist Loss: 0.0, Recon Loss: 3.944721682514405, Time Loss: 0.1540095357119631
EarlyStopping counter: 5 out of 10
Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:08<00:00,  1.18s/it]
Train loss: 11.046850092724936, Disc Loss: 15.96471892309331, Adv Loss: 1.0289491280424479, FM Loss: 0.1169797672227844, Recon Loss: 3.8391386625560537, Time Loss: 0.11067057663156572
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:52<00:00,  1.24it/s]
Valid loss: 7.883246750807234, Dist Loss: 0.0, Recon Loss: 3.928453937299816, Time Loss: 0.1316943515498299
EarlyStopping counter: 6 out of 10
Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [46:59<00:00,  1.20s/it]
Train loss: 11.18808522811584, Disc Loss: 15.95917327971879, Adv Loss: 1.1316403753461866, FM Loss: 0.12181912435589316, Recon Loss: 3.810049749406084, Time Loss: 0.10895215434549614
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:49<00:00,  1.25it/s]
Valid loss: 7.566517880259421, Dist Loss: 0.0, Recon Loss: 3.7701263963871554, Time Loss: 0.13132547239377917
EarlyStopping counter: 7 out of 10
Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:05<00:00,  1.20s/it]
Train loss: 11.342396913308207, Disc Loss: 15.952282834469536, Adv Loss: 1.1192120363928686, FM Loss: 0.13123721044318545, Recon Loss: 3.799225585634372, Time Loss: 0.10844049963054121
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:53<00:00,  1.24it/s]
Valid loss: 7.769034417361985, Dist Loss: 0.0, Recon Loss: 3.8715134353410243, Time Loss: 0.13003770581540197
EarlyStopping counter: 8 out of 10
Epoch 12
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [45:50<00:00,  1.17s/it]
Train loss: nan, Disc Loss: 15.950994620792502, Adv Loss: 1.2564962002689604, FM Loss: nan, Recon Loss: 3.7901669499413937, Time Loss: 0.10851993706850331
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:40<00:00,  1.27it/s]
Valid loss: 7.537911262382234, Dist Loss: 0.0, Recon Loss: 3.7559446898595237, Time Loss: 0.13010942055391594
EarlyStopping counter: 9 out of 10
Epoch 13
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2347/2347 [47:06<00:00,  1.20s/it]
Train loss: 11.481305026886155, Disc Loss: 15.949160497443545, Adv Loss: 1.2382199807932999, FM Loss: 0.1364169809530784, Recon Loss: 3.7573725010010857, Time Loss: 0.10831529054430428
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 587/587 [07:44<00:00,  1.26it/s]
Valid loss: 7.759723095512065, Dist Loss: 0.0, Recon Loss: 3.866793262897602, Time Loss: 0.13068285121802983
EarlyStopping counter: 10 out of 10
Early stopping
r@Azumith:~/Documents/Projects/orpheus/orpheus$
